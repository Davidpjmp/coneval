{
  "hash": "a26b7585eaadbbf0038bc394466723ba",
  "result": {
    "markdown": "# Manejo de datos: importación, selección y revisión\n\n## Previo\n\n\n::: {.cell}\n\n:::\n\n\nVamos a llamar algunas librerías básicas, el tidyverse (que son muchas librerías) y sjlabelled que nos sirve para el manejo de etiquetas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(\"pacman\")) install.packages(\"pacman\") # instala pacman si se requiere\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: pacman\n```\n:::\n\n```{.r .cell-code}\npacman::p_load(tidyverse, haven, sjlabelled, foreign, janitor) #carga los paquetes necesarios para esta práctica\n```\n:::\n\n\n## Importación de datos\n\n### Desde Excel\n\nEl paquete más compatible con RStudio es readxl. A veces, otros paquetes tienen más problemas de configuración entre R y el Java.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nejemploxl <- readxl::read_excel(\"datos/ejemplo_xlsx.xlsx\", sheet = \"para_importar\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...128`\n• `` -> `...129`\n• `` -> `...132`\n• `PIB (Paridad de Poder Adquisitivo)` -> `PIB (Paridad de Poder\n  Adquisitivo)...135`\n• `PIB (Paridad de Poder Adquisitivo)` -> `PIB (Paridad de Poder\n  Adquisitivo)...136`\n• `PIB per cápita (Paridad de Poder Adquisitivo)` -> `PIB per cápita (Paridad\n  de Poder Adquisitivo)...137`\n• `PIB per cápita (Paridad de Poder Adquisitivo)` -> `PIB per cápita (Paridad\n  de Poder Adquisitivo)...138`\n• `PIB per cápita` -> `PIB per cápita...139`\n• `PIB per cápita` -> `PIB per cápita...140`\n• `PIB` -> `PIB...141`\n• `PIB` -> `PIB...142`\n```\n:::\n:::\n\n\nComo el nombre de paquete lo indica, sólo lee. Para escribir en este formato, recomiendo el paquete \"writexl\". Lo instalamos anteriormente.\n\nSi quisiéramos exportar un objeto a Excel\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwritexl::write_xlsx(ejemploxl, path = \"Mi_Exportación.xlsx\")\n```\n:::\n\n\n### Desde STATA y SPSS\n\nSi bien también se puede realizar desde el paquete foreign. Pero este no importa algunas características como las etiquetas y tampoco funciona con las versiones más nuevas de STATA. Vamos a instalar otro paquete, compatible con el mundo tidyverse.\n\nRecuerda que no hay que instalarlo (viene adentro de tidyverse). Se instalasólo la primera vez. Una vez instalado un paquete, lo llamamos con el comando \"library\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 <- haven::read_dta(\"datos/concentrado2020.dta\")\n```\n:::\n\n\n!Importante, a R no le gustan los objetos con nombres que empiezan en números\n\nEl paquete haven sí exporta información.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhaven::write_dta(concentrado2020, \"datos/mi_exportación.dta\", version = 12)\n```\n:::\n\n\nCon SSPS es muy parecido. Dentro de \"haven\" hay una función específica para ello.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#encevi_hogar<- haven::read_sav(\"datos/encevi_hogar.sav\")\n```\n:::\n\n\nPara escribir\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#haven::write_sav(concentrado2020 , \"mi_exportacion.sav\")\n```\n:::\n\n\nCheca que en todas las exportaciones en los nombres hay que incluir la extensión del programa. Si quieres guardar en un lugar diferente al directorio del trabajo, hay que escribir toda la ruta dentro de la computadora.\n\n## Revisión de nuestra base\n\nVamos a revisar la base, brevemente la base\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(concentrado2020) # tipo de objeto\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"tbl_df\"     \"tbl\"        \"data.frame\"\n```\n:::\n\n```{.r .cell-code}\nnames(concentrado2020) # lista las variables\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"folioviv\"   \"foliohog\"   \"ubica_geo\"  \"tam_loc\"    \"est_socio\" \n  [6] \"est_dis\"    \"upm\"        \"factor\"     \"clase_hog\"  \"sexo_jefe\" \n [11] \"edad_jefe\"  \"educa_jefe\" \"tot_integ\"  \"hombres\"    \"mujeres\"   \n [16] \"mayores\"    \"menores\"    \"p12_64\"     \"p65mas\"     \"ocupados\"  \n [21] \"percep_ing\" \"perc_ocupa\" \"ing_cor\"    \"ingtrab\"    \"trabajo\"   \n [26] \"sueldos\"    \"horas_extr\" \"comisiones\" \"aguinaldo\"  \"indemtrab\" \n [31] \"otra_rem\"   \"remu_espec\" \"negocio\"    \"noagrop\"    \"industria\" \n [36] \"comercio\"   \"servicios\"  \"agrope\"     \"agricolas\"  \"pecuarios\" \n [41] \"reproducc\"  \"pesca\"      \"otros_trab\" \"rentas\"     \"utilidad\"  \n [46] \"arrenda\"    \"transfer\"   \"jubilacion\" \"becas\"      \"donativos\" \n [51] \"remesas\"    \"bene_gob\"   \"transf_hog\" \"trans_inst\" \"estim_alqu\"\n [56] \"otros_ing\"  \"gasto_mon\"  \"alimentos\"  \"ali_dentro\" \"cereales\"  \n [61] \"carnes\"     \"pescado\"    \"leche\"      \"huevo\"      \"aceites\"   \n [66] \"tuberculo\"  \"verduras\"   \"frutas\"     \"azucar\"     \"cafe\"      \n [71] \"especias\"   \"otros_alim\" \"bebidas\"    \"ali_fuera\"  \"tabaco\"    \n [76] \"vesti_calz\" \"vestido\"    \"calzado\"    \"vivienda\"   \"alquiler\"  \n [81] \"pred_cons\"  \"agua\"       \"energia\"    \"limpieza\"   \"cuidados\"  \n [86] \"utensilios\" \"enseres\"    \"salud\"      \"atenc_ambu\" \"hospital\"  \n [91] \"medicinas\"  \"transporte\" \"publico\"    \"foraneo\"    \"adqui_vehi\"\n [96] \"mantenim\"   \"refaccion\"  \"combus\"     \"comunica\"   \"educa_espa\"\n[101] \"educacion\"  \"esparci\"    \"paq_turist\" \"personales\" \"cuida_pers\"\n[106] \"acces_pers\" \"otros_gas\"  \"transf_gas\" \"percep_tot\" \"retiro_inv\"\n[111] \"prestamos\"  \"otras_perc\" \"ero_nm_viv\" \"ero_nm_hog\" \"erogac_tot\"\n[116] \"cuota_viv\"  \"mater_serv\" \"material\"   \"servicio\"   \"deposito\"  \n[121] \"prest_terc\" \"pago_tarje\" \"deudas\"     \"balance\"    \"otras_erog\"\n[126] \"smg\"       \n```\n:::\n\n```{.r .cell-code}\nhead(concentrado2020) # muestra las primeras 6 líneas\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 126\n  folioviv  folio…¹ ubica…² tam_loc est_s…³ est_dis upm   factor clase…⁴ sexo_…⁵\n  <chr>     <chr>   <chr>   <chr>   <chr>   <chr>   <chr>  <dbl> <chr>   <chr>  \n1 01000136… 1       01001   1       3       002     0000…    190 2       2      \n2 01000136… 1       01001   1       3       002     0000…    190 2       1      \n3 01000178… 1       01001   1       3       002     0000…    189 2       1      \n4 01000178… 1       01001   1       3       002     0000…    189 2       1      \n5 01000178… 1       01001   1       3       002     0000…    189 2       1      \n6 01000178… 1       01001   1       3       002     0000…    189 2       1      \n# … with 116 more variables: edad_jefe <dbl>, educa_jefe <chr>,\n#   tot_integ <dbl>, hombres <dbl>, mujeres <dbl>, mayores <dbl>,\n#   menores <dbl>, p12_64 <dbl>, p65mas <dbl>, ocupados <dbl>,\n#   percep_ing <dbl>, perc_ocupa <dbl>, ing_cor <dbl>, ingtrab <dbl>,\n#   trabajo <dbl>, sueldos <dbl>, horas_extr <dbl>, comisiones <dbl>,\n#   aguinaldo <dbl>, indemtrab <dbl>, otra_rem <dbl>, remu_espec <dbl>,\n#   negocio <dbl>, noagrop <dbl>, industria <dbl>, comercio <dbl>, …\n```\n:::\n\n```{.r .cell-code}\ntable(concentrado2020$clase_hog) # un tabulado simple\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n    1     2     3     4     5 \n10842 55339 21819   717   289 \n```\n:::\n:::\n\n\n## Revisión con dplyr\n\nOperador de \"pipe\" o \"tubería\" %\\>% (Ctrl+Shift+M) Antes de continuar, presentemos el operador \"pipe\" %\\>%. dplyr importa este operador de otro paquete (magrittr). Este operador le permite canalizar la salida de una función a la entrada de otra función. En lugar de funciones de anidamiento (lectura desde adentro hacia afuera), la idea de la tubería es leer las funciones de izquierda a derecha.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n    dplyr::select(sexo_jefe, edad_jefe) %>% \n    head\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n  sexo_jefe edad_jefe\n  <chr>         <dbl>\n1 2                48\n2 1                46\n3 1                26\n4 1                29\n5 1                63\n6 1                33\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n    dplyr::select(sexo_jefe, edad_jefe) %>% \n    glimpse\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 89,006\nColumns: 2\n$ sexo_jefe <chr> \"2\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"2\", …\n$ edad_jefe <dbl> 48, 46, 26, 29, 63, 33, 60, 76, 74, 37, 76, 79, 37, 80, 46, …\n```\n:::\n:::\n\n\n## Etiquetas y cómo usarlas\n\nPodemos ver que los objetos \"data.frame\"(*spoiler*, ya hablaremos de ellos)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(concentrado2020$sexo_jefe)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"character\"\n```\n:::\n:::\n\n\n### Ejemplo de etiquetado\n\nPara que se vea mejor nuestro tabulado, sería bueno que nuestras variables tuvieran etiqueta. Para ello utilizaremos el paquete \"sjlabelled\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\netiqueta_sex<-c(\"Hombre\", \"Mujer\")\n\nconcentrado2020<-concentrado2020 %>% \n  mutate(sexo_jefe=as_numeric(sexo_jefe)) %>% # para quitar el \"string\"\n  sjlabelled::set_labels(sexo_jefe, labels=etiqueta_sex) \n```\n:::\n\n\nEtiquetemos también la variable \"clase_hog\". Podemos checar cómo está estructurada esta base acá <https://www.inegi.org.mx/rnm/index.php/catalog/685/data-dictionary>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020<-concentrado2020 %>% \n  mutate(clase_hog=as_numeric(clase_hog)) %>% # para quitar el \"string\"\n  sjlabelled::set_labels(clase_hog, labels=c(\"unipersonal\",\n                                             \"nuclear\", \n                                             \"ampliado\",\n                                             \"compuesto\",\n                                             \"corresidente\")) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(concentrado2020$sexo_jefe)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n    1     2 \n63230 25776 \n```\n:::\n\n```{.r .cell-code}\ntable(sjlabelled::as_label(concentrado2020$sexo_jefe))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nHombre  Mujer \n 63230  25776 \n```\n:::\n:::\n\n\n### Ojeando\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndplyr::glimpse(concentrado2020)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 89,006\nColumns: 126\n$ folioviv   <chr> \"0100013605\", \"0100013606\", \"0100017801\", \"0100017802\", \"01…\n$ foliohog   <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\",…\n$ ubica_geo  <chr> \"01001\", \"01001\", \"01001\", \"01001\", \"01001\", \"01001\", \"0100…\n$ tam_loc    <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\",…\n$ est_socio  <chr> \"3\", \"3\", \"3\", \"3\", \"3\", \"3\", \"3\", \"3\", \"3\", \"3\", \"3\", \"3\",…\n$ est_dis    <chr> \"002\", \"002\", \"002\", \"002\", \"002\", \"002\", \"002\", \"002\", \"00…\n$ upm        <chr> \"0000001\", \"0000001\", \"0000002\", \"0000002\", \"0000002\", \"000…\n$ factor     <dbl> 190, 190, 189, 189, 189, 189, 189, 168, 168, 168, 168, 168,…\n$ clase_hog  <dbl> 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 1, 1, 1, 3, 3, 2, 3, 5, 2,…\n$ sexo_jefe  <dbl> 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 1, 1, 2, 1, 1,…\n$ edad_jefe  <dbl> 48, 46, 26, 29, 63, 33, 60, 76, 74, 37, 76, 79, 37, 80, 46,…\n$ educa_jefe <chr> \"09\", \"08\", \"10\", \"08\", \"10\", \"06\", \"03\", \"08\", \"03\", \"06\",…\n$ tot_integ  <dbl> 3, 4, 2, 2, 2, 4, 3, 2, 2, 6, 6, 1, 1, 1, 2, 3, 3, 2, 2, 5,…\n$ hombres    <dbl> 1, 3, 1, 2, 1, 2, 2, 1, 1, 3, 4, 0, 1, 0, 0, 2, 1, 1, 2, 3,…\n$ mujeres    <dbl> 2, 1, 1, 0, 1, 2, 1, 1, 1, 3, 2, 1, 0, 1, 2, 1, 2, 1, 0, 2,…\n$ mayores    <dbl> 3, 3, 2, 1, 2, 2, 3, 2, 2, 3, 6, 1, 1, 1, 2, 3, 2, 2, 2, 5,…\n$ menores    <dbl> 0, 1, 0, 1, 0, 2, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,…\n$ p12_64     <dbl> 3, 3, 2, 1, 2, 2, 3, 0, 0, 3, 4, 0, 1, 0, 2, 1, 2, 1, 2, 5,…\n$ p65mas     <dbl> 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 2, 1, 0, 1, 0, 2, 0, 1, 0, 0,…\n$ ocupados   <dbl> 1, 1, 2, 1, 1, 1, 1, 0, 1, 3, 1, 1, 1, 0, 2, 0, 1, 1, 2, 2,…\n$ percep_ing <dbl> 2, 2, 2, 1, 1, 1, 2, 1, 2, 2, 5, 1, 1, 1, 1, 2, 1, 2, 2, 3,…\n$ perc_ocupa <dbl> 1, 1, 2, 1, 1, 1, 1, 0, 1, 2, 1, 1, 1, 0, 1, 0, 1, 1, 2, 2,…\n$ ing_cor    <dbl> 16229.49, 31425.68, 33979.16, 71557.37, 90703.26, 30368.84,…\n$ ingtrab    <dbl> 13278.68, 22254.09, 33979.16, 71557.37, 48113.11, 30368.84,…\n$ trabajo    <dbl> 0.00, 22254.09, 24098.35, 71557.37, 48113.11, 30368.84, 148…\n$ sueldos    <dbl> 0.00, 21639.34, 23606.55, 67868.85, 47213.11, 29508.19, 140…\n$ horas_extr <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ comisiones <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ aguinaldo  <dbl> 0.00, 614.75, 491.80, 3688.52, 0.00, 860.65, 737.70, 0.00, …\n$ indemtrab  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ otra_rem   <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ remu_espec <dbl> 0.00, 0.00, 0.00, 0.00, 900.00, 0.00, 0.00, 0.00, 0.00, 0.0…\n$ negocio    <dbl> 1573.77, 0.00, 9880.81, 0.00, 0.00, 0.00, 0.00, 0.00, 8659.…\n$ noagrop    <dbl> 1573.77, 0.00, 9880.81, 0.00, 0.00, 0.00, 0.00, 0.00, 8659.…\n$ industria  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ comercio   <dbl> 1573.77, 0.00, 9880.81, 0.00, 0.00, 0.00, 0.00, 0.00, 8659.…\n$ servicios  <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ agrope     <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ agricolas  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ pecuarios  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ reproducc  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ pesca      <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ otros_trab <dbl> 11704.91, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n$ rentas     <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 15497…\n$ utilidad   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 154979, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ arrenda    <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ transfer   <dbl> 2459.01, 1671.59, 0.00, 0.00, 22131.14, 0.00, 25967.21, 130…\n$ jubilacion <dbl> 0.00, 0.00, 0.00, 0.00, 22131.14, 0.00, 25967.21, 7336.95, …\n$ becas      <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ donativos  <dbl> 885.24, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 29.34, 0.…\n$ remesas    <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ bene_gob   <dbl> 1573.77, 1573.77, 0.00, 0.00, 0.00, 0.00, 0.00, 5086.95, 10…\n$ transf_hog <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 606.51, 0.00, 0.0…\n$ trans_inst <dbl> 0.00, 97.82, 0.00, 0.00, 0.00, 0.00, 0.00, 58.69, 0.00, 0.0…\n$ estim_alqu <dbl> 0.00, 7500.00, 0.00, 0.00, 18000.00, 0.00, 12000.00, 11612.…\n$ otros_ing  <dbl> 491.80, 0.00, 0.00, 0.00, 2459.01, 0.00, 0.00, 0.00, 0.00, …\n$ gasto_mon  <dbl> 24626.04, 20397.10, 44955.73, 82950.42, 30140.68, 39991.94,…\n$ alimentos  <dbl> 14732.80, 9321.32, 15081.32, 26921.53, 11969.93, 7547.03, 1…\n$ ali_dentro <dbl> 13549.96, 9321.32, 9295.63, 22164.39, 3355.69, 7547.03, 112…\n$ cereales   <dbl> 3990.78, 1324.26, 1594.26, 2441.54, 0.00, 1529.96, 1259.98,…\n$ carnes     <dbl> 989.99, 3882.84, 0.00, 4513.33, 3034.27, 4204.25, 2031.41, …\n$ pescado    <dbl> 0.00, 0.00, 0.00, 1025.87, 0.00, 0.00, 771.42, 0.00, 0.00, …\n$ leche      <dbl> 1613.54, 925.71, 0.00, 449.99, 321.42, 321.42, 2494.25, 707…\n$ huevo      <dbl> 822.85, 745.70, 925.71, 0.00, 0.00, 244.28, 642.85, 0.00, 0…\n$ aceites    <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 1067.13, 0.00, 0.00, 0.00, 0.…\n$ tuberculo  <dbl> 347.14, 0.00, 0.00, 197.48, 0.00, 0.00, 0.00, 411.42, 0.00,…\n$ verduras   <dbl> 655.70, 1157.10, 385.71, 2413.26, 0.00, 0.00, 1896.37, 3439…\n$ frutas     <dbl> 0.00, 0.00, 0.00, 1367.85, 0.00, 0.00, 642.85, 1504.25, 0.0…\n$ azucar     <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ cafe       <dbl> 925.71, 0.00, 0.00, 86.52, 0.00, 0.00, 0.00, 77.14, 0.00, 0…\n$ especias   <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ otros_alim <dbl> 3304.26, 1285.71, 3278.56, 9668.55, 0.00, 179.99, 1542.85, …\n$ bebidas    <dbl> 899.99, 0.00, 3111.39, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, …\n$ ali_fuera  <dbl> 1182.84, 0.00, 5785.69, 4757.14, 8614.24, 0.00, 0.00, 0.00,…\n$ tabaco     <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ vesti_calz <dbl> 0.00, 0.00, 1006.60, 4509.73, 0.00, 371.73, 0.00, 215.21, 0…\n$ vestido    <dbl> 0.00, 0.00, 1006.60, 4294.52, 0.00, 0.00, 0.00, 215.21, 0.0…\n$ calzado    <dbl> 0.00, 0.00, 0.00, 215.21, 0.00, 371.73, 0.00, 0.00, 0.00, 0…\n$ vivienda   <dbl> 2850.00, 2308.50, 11097.00, 13984.50, 3179.50, 12450.00, 34…\n$ alquiler   <dbl> 0.00, 0.00, 9000.00, 12000.00, 0.00, 10500.00, 0.00, 0.00, …\n$ pred_cons  <dbl> 0.0, 0.0, 0.0, 0.0, 212.5, 0.0, 300.0, 100.0, 100.0, 150.0,…\n$ agua       <dbl> 750.00, 990.00, 420.00, 756.00, 408.00, 1500.00, 600.00, 39…\n$ energia    <dbl> 2100.00, 1318.50, 1677.00, 1228.50, 2559.00, 450.00, 2550.0…\n$ limpieza   <dbl> 375.00, 924.00, 2530.16, 708.00, 920.80, 408.00, 845.73, 72…\n$ cuidados   <dbl> 375.00, 924.00, 2403.00, 708.00, 429.00, 408.00, 699.00, 72…\n$ utensilios <dbl> 0.00, 0.00, 39.13, 0.00, 0.00, 0.00, 146.73, 0.00, 0.00, 0.…\n$ enseres    <dbl> 0.00, 0.00, 88.03, 0.00, 491.80, 0.00, 0.00, 0.00, 0.00, 0.…\n$ salud      <dbl> 0.00, 782.60, 4509.77, 39.13, 2412.39, 229.87, 213.25, 309.…\n$ atenc_ambu <dbl> 0.00, 782.60, 3913.04, 0.00, 0.00, 229.87, 0.00, 309.12, 0.…\n$ hospital   <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ medicinas  <dbl> 0.00, 0.00, 596.73, 39.13, 2412.39, 0.00, 213.25, 0.00, 426…\n$ transporte <dbl> 5447.24, 4915.68, 7029.68, 7022.39, 7154.75, 16171.31, 4200…\n$ publico    <dbl> 1812.82, 1465.68, 514.28, 899.99, 0.00, 1594.27, 0.00, 1092…\n$ foraneo    <dbl> 634.42, 0.00, 1475.40, 1475.40, 0.00, 0.00, 0.00, 0.00, 0.0…\n$ adqui_vehi <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 7377.04, 0.00, 0.00, 0.00, 0.…\n$ mantenim   <dbl> 0.00, 1200.00, 3000.00, 0.00, 6014.75, 1950.00, 3000.00, 11…\n$ refaccion  <dbl> 0.00, 0.00, 0.00, 0.00, 2114.75, 0.00, 0.00, 538.04, 0.00, …\n$ combus     <dbl> 0.00, 1200.00, 3000.00, 0.00, 3900.00, 1950.00, 3000.00, 58…\n$ comunica   <dbl> 3000.00, 2250.00, 2040.00, 4647.00, 1140.00, 5250.00, 1200.…\n$ educa_espa <dbl> 120.00, 0.00, 693.44, 26408.75, 1440.00, 1035.00, 0.00, 0.0…\n$ educacion  <dbl> 120.00, 0.00, 0.00, 7650.00, 0.00, 1035.00, 0.00, 0.00, 0.0…\n$ esparci    <dbl> 0.00, 0.00, 693.44, 13840.72, 1440.00, 0.00, 0.00, 0.00, 0.…\n$ paq_turist <dbl> 0.00, 0.00, 0.00, 4918.03, 0.00, 0.00, 0.00, 0.00, 0.00, 0.…\n$ personales <dbl> 1101.00, 2145.00, 2766.78, 2767.30, 112.50, 1779.00, 521.50…\n$ cuida_pers <dbl> 1101.00, 2145.00, 2082.00, 2601.00, 0.00, 1029.00, 384.00, …\n$ acces_pers <dbl> 0.00, 0.00, 684.78, 166.30, 0.00, 0.00, 0.00, 0.00, 0.00, 1…\n$ otros_gas  <dbl> 0.00, 0.00, 0.00, 0.00, 112.50, 750.00, 137.50, 125.00, 0.0…\n$ transf_gas <dbl> 0.00, 0.00, 240.98, 589.09, 2950.81, 0.00, 0.00, 386.40, 0.…\n$ percep_tot <dbl> 0.00, 2571.42, 6014.03, 1799.99, 4885.71, 5528.56, 0.00, 22…\n$ retiro_inv <dbl> 0.00, 0.00, 3442.61, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.…\n$ prestamos  <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ otras_perc <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 48.91, 0.00, 2445…\n$ ero_nm_viv <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ ero_nm_hog <dbl> 0.00, 2571.42, 2571.42, 1799.99, 4885.71, 5528.56, 0.00, 22…\n$ erogac_tot <dbl> 0.00, 2360.65, 1062.28, 885.24, 5901.63, 0.00, 0.00, 0.00, …\n$ cuota_viv  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ mater_serv <dbl> 0.00, 0.00, 78.68, 0.00, 0.00, 0.00, 0.00, 0.00, 29.34, 0.0…\n$ material   <dbl> 0.00, 0.00, 78.68, 0.00, 0.00, 0.00, 0.00, 0.00, 29.34, 0.0…\n$ servicio   <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ deposito   <dbl> 0.00, 0.00, 983.60, 0.00, 5901.63, 0.00, 0.00, 0.00, 0.00, …\n$ prest_terc <dbl> 0.00, 0.00, 0.00, 885.24, 0.00, 0.00, 0.00, 0.00, 0.00, 0.0…\n$ pago_tarje <dbl> 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,…\n$ deudas     <dbl> 0.00, 2360.65, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.…\n$ balance    <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ otras_erog <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ smg        <dbl> 11089.8, 11089.8, 11089.8, 11089.8, 11089.8, 11089.8, 11089…\n```\n:::\n\n```{.r .cell-code}\ndplyr::glimpse(concentrado2020[,20:30]) # en corchete del lado derecho podemos ojear columnas \n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 89,006\nColumns: 11\n$ ocupados   <dbl> 1, 1, 2, 1, 1, 1, 1, 0, 1, 3, 1, 1, 1, 0, 2, 0, 1, 1, 2, 2,…\n$ percep_ing <dbl> 2, 2, 2, 1, 1, 1, 2, 1, 2, 2, 5, 1, 1, 1, 1, 2, 1, 2, 2, 3,…\n$ perc_ocupa <dbl> 1, 1, 2, 1, 1, 1, 1, 0, 1, 2, 1, 1, 1, 0, 1, 0, 1, 1, 2, 2,…\n$ ing_cor    <dbl> 16229.49, 31425.68, 33979.16, 71557.37, 90703.26, 30368.84,…\n$ ingtrab    <dbl> 13278.68, 22254.09, 33979.16, 71557.37, 48113.11, 30368.84,…\n$ trabajo    <dbl> 0.00, 22254.09, 24098.35, 71557.37, 48113.11, 30368.84, 148…\n$ sueldos    <dbl> 0.00, 21639.34, 23606.55, 67868.85, 47213.11, 29508.19, 140…\n$ horas_extr <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ comisiones <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ aguinaldo  <dbl> 0.00, 614.75, 491.80, 3688.52, 0.00, 860.65, 737.70, 0.00, …\n$ indemtrab  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n```\n:::\n:::\n\n\nPodemos hacer un tipo \"labelbook\", usando una función que viene de la librería \"sjlabelled\", \"get_labels\". Funciona para toda la base o para columnas, o para variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#print(get_labels(concentrado2020)) #todas\nprint(get_labels(concentrado2020[, 20:30])) #de las segundas 10 variables\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$ocupados\nNULL\n\n$percep_ing\nNULL\n\n$perc_ocupa\nNULL\n\n$ing_cor\nNULL\n\n$ingtrab\nNULL\n\n$trabajo\nNULL\n\n$sueldos\nNULL\n\n$horas_extr\nNULL\n\n$comisiones\nNULL\n\n$aguinaldo\nNULL\n\n$indemtrab\nNULL\n```\n:::\n:::\n\n\nNo tienen :(\n\nEn singular nos da las etiquetas de las variables, no de los valores:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#print(get_label(concentrado2020)) #todas\nprint(get_label(concentrado2020[, 1:10])) #de las primeras 10 variables\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      folioviv                       foliohog \n\"Identificador de la vivienda\"      \"Identificador del hogar\" \n                     ubica_geo                        tam_loc \n        \"Ubicación geográfica\"          \"Tamaño de localidad\" \n                     est_socio                        est_dis \n      \"Estrato socioeconómico\"   \"Estrato de diseño muestral\" \n                           upm                         factor \n \"Unidad primaria de muestreo\"          \"Factor de expansión\" \n                     clase_hog                      sexo_jefe \n              \"Clase de hogar\"      \"Sexo del jefe del hogar\" \n```\n:::\n\n```{.r .cell-code}\nprint(get_label(concentrado2020$clase_hog)) #\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Clase de hogar\"\n```\n:::\n:::\n\n\n### Selección de casos y de variables\n\nPoco a poco vamos comprendiendo más la lógica de R. Hay varias \"formas\" de programar. Por lo que no te asustes si varios códigos llegan al mismo resultado\n\nPara revisar el contenido de un data frame podemos usar, como lo hicimos anteriormente, el formato basededatos\\$var o usar corchete, checa como estas cuatro formas tan el mismo resultado.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx<-concentrado2020$ing_cor\nx<-concentrado2020[[\"ing_cor\"]]  # ¡Ojo con las comillas! \nx<-concentrado2020[,23]\nx<-concentrado2020[,\"ing_cor\"]\n```\n:::\n\n\nAhora, con el formato de dplyr podemos llegar a lo mismo\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx<-concentrado2020 %>% \n  select(ing_cor)\n```\n:::\n\n\n## \"Subsetting\"\n\nSelección \"inversa\" O sea no \"botar algo\", es con el negativo. No funciona con todos los formatos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx<-concentrado2020 %>% \n  select(-ing_cor)\n\nrm(x) #rm sólo bota objetos\n```\n:::\n\n\nPero con los otros formatos podemos \"asignar\" valores adentro de un data.frame, y uno de eso valores puede ser \"la nada\"\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020$aproba2<-concentrado2020$ing_cor\nconcentrado2020$aproba2<-NULL\n```\n:::\n\n\nDe aquí viene esa cuesta en el aprendizaje; tenemos que comprender en qué forma programó el que hizo la librería e incluso a veces cómo aprendió quién te está enseñando o el foro que estás leyendo.\n\nRara vez utilizamos una base de datos completa, y rara vez queremos hacer operaciones completas con ellas.\n\nVamos a pedir cosas más específicas y podemos seleccionar observaciones o filas. Como nuestra base de datos es muy grande, guardaremos el filtro o selección en un objeto.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsubset1<-concentrado2020[concentrado2020$ing_cor>5000,]\n```\n:::\n\n\nTambién podemos seleccionar columnas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsubset2<- concentrado2020[, c(\"sexo_jefe\", \"edad_jefe\", \"ing_cor\")]\n```\n:::\n\n\npodemos combinar los dos tipos de selección\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsubset3<- concentrado2020[(concentrado2020$ing_cor>5000 & concentrado2020$sexo_jefe==1 ), c(\"sexo_jefe\", \"edad_jefe\", \"ing_cor\")]\n```\n:::\n\n\nCon dplyr, podemos usar \"filter\" y \"select\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsubset4<-concentrado2020 %>% \n  dplyr::filter(ing_cor>5000 & sexo_jefe==1) %>%\n    dplyr::select(sexo_jefe, edad_jefe, ing_cor)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}