{
  "hash": "336b7ed0d2344f0f92b33632ad1a4060",
  "result": {
    "markdown": "# Análisis descriptivo básico\n\nVamos a llamar algunas librerías básicas, el tidyverse (que son muchas librerías) y sjlabelled que nos sirve para el manejo de etiquetas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(\"pacman\")) install.packages(\"pacman\") # instala pacman si se requiere\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: pacman\n```\n:::\n\n```{.r .cell-code}\npacman::p_load(tidyverse, haven, sjlabelled, foreign, janitor) #carga los paquetes necesarios para esta práctica\n```\n:::\n\n\nE importamos la base\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 <- haven::read_dta(\"datos/concentrado2020.dta\", encoding=\"latin1\")\n```\n:::\n\n\n## Variables nominales\n\nLa variable nominal \"sexo_jefe\", se captura con \"1\" para hombres y con un \"2\" para mujeres en la base de datos. Podemos establecer una operación de igual y además sumar los casos que cumplan con esta condición:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  dplyr::count(sexo_jefe==2) # cuentan los casos que cumplen con la condición \"sexo_jefe==2\"\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  `sexo_jefe == 2`     n\n  <lgl>            <int>\n1 FALSE            63230\n2 TRUE             25776\n```\n:::\n:::\n\n\nEsto es a lo que nos referimos con contar frecuencias. Podemos contar casos que cumplan con una operación de igualdad.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>%\n  with(\n    table(sexo_jefe)\n    )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nsexo_jefe\n    1     2 \n63230 25776 \n```\n:::\n:::\n\n\nCon \"tabyl()\"\" de \"janitor\"\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>%\n  dplyr::mutate(sexo_jefe=as_label(sexo_jefe))  %>%\n  janitor::tabyl(sexo_jefe)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n sexo_jefe     n   percent\n         1 63230 0.7104015\n         2 25776 0.2895985\n```\n:::\n:::\n\n\nPara ver que esto es una distribución de frecuencias sería muy útil ver la proporción total, ello se realiza agregando un elemento más en nuestro código con una \"tubería\":\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  dplyr::mutate(sexo_jefe=as_label(sexo_jefe))  %>%\n  janitor::tabyl(sexo_jefe) %>% \n  janitor::adorn_totals()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n sexo_jefe     n   percent\n         1 63230 0.7104015\n         2 25776 0.2895985\n     Total 89006 1.0000000\n```\n:::\n:::\n\n\nHoy revisamos algunos tipos de variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(concentrado2020$sexo_jefe) # variable sin etiqueta\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"character\"\n```\n:::\n\n```{.r .cell-code}\nclass(as_label(concentrado2020$sexo_jefe)) # variable con etiqueta\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"character\"\n```\n:::\n\n```{.r .cell-code}\nclass(as_label(concentrado2020$ing_cor)) # variable ordinal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"numeric\"\n```\n:::\n\n```{.r .cell-code}\nclass(as_label(concentrado2020$money)) # variable de intervalo/razón\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Unknown or uninitialised column: `money`.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"NULL\"\n```\n:::\n:::\n\n\nEn general, tendremos variables de factor que podrían ser consideradas como cualitativas y numéricas. Aunque en realidad, R tiene muchas formas de almacenamiento. Como mostramos con el comando \"glimpse()\" en capítulo anterior, podemos revisar una variable en específico:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndplyr::glimpse(concentrado2020$sexo_jefe)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n chr [1:89006] \"2\" \"1\" \"1\" \"1\" \"1\" \"1\" \"1\" \"1\" \"1\" \"1\" \"1\" \"2\" \"1\" \"2\" \"2\" ...\n - attr(*, \"label\")= chr \"Sexo del jefe del hogar\"\n - attr(*, \"format.stata\")= chr \"%1s\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% mutate(sexo_jefe=as_label(sexo_jefe)) %>% # cambia los valores de la variable a sus etiquetas\n                tabyl(sexo_jefe) %>% # para hacer la tabla\n                adorn_totals() %>% # añade totales\n                adorn_pct_formatting()  # nos da porcentaje en lugar de proporción\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n sexo_jefe     n percent\n         1 63230   71.0%\n         2 25776   29.0%\n     Total 89006  100.0%\n```\n:::\n:::\n\n\nLa tubería o \"pipe\" %\\>% nos permite ir agregando elementos de manera sencilla nuestros comandos. En este caso decimos que dentro del objeto haga el cambio, luego la tabla, que le ponga porcentajes y finalmente que nos dé los totales. El total del 100% no aparece, por un elemento propio del programa.\n\n## Variables ordinales\n\nSon variables que dan cuenta de cualidades o condiciones a través de categorías que guardan un orden entre sí.\n\nVamos a darle una \"ojeada\" a esta variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(concentrado2020$educa_jefe\n        )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n chr [1:89006] \"09\" \"08\" \"10\" \"08\" \"10\" \"06\" \"03\" \"08\" \"03\" \"06\" \"03\" \"03\" ...\n - attr(*, \"label\")= chr \"Educación formal del jefe del hogar\"\n - attr(*, \"format.stata\")= chr \"%2s\"\n```\n:::\n:::\n\n\nHoy hacemos la tabla, con las etiquetas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>%\n  mutate(educa_jefe=as_label(educa_jefe)) %>% \n  tabyl(educa_jefe)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n educa_jefe     n     percent\n         01  6160 0.069208817\n         02    20 0.000224704\n         03 14577 0.163775476\n         04 15136 0.170055951\n         05  2974 0.033413478\n         06 23865 0.268127991\n         07  3029 0.034031414\n         08 10550 0.118531335\n         09  2535 0.028481226\n         10  8474 0.095207065\n         11  1686 0.018942543\n```\n:::\n:::\n\n\nPara que no nos salgan las categorías sin datos podemos poner una opción dentro del comando \"tabyl()\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  mutate(educa_jefe=as_label(educa_jefe)) %>% \n  tabyl(educa_jefe, show_missing_levels=F ) %>% # esta opción elimina los valores con 0\n  adorn_totals()  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n educa_jefe     n     percent\n         01  6160 0.069208817\n         02    20 0.000224704\n         03 14577 0.163775476\n         04 15136 0.170055951\n         05  2974 0.033413478\n         06 23865 0.268127991\n         07  3029 0.034031414\n         08 10550 0.118531335\n         09  2535 0.028481226\n         10  8474 0.095207065\n         11  1686 0.018942543\n      Total 89006 1.000000000\n```\n:::\n:::\n\n\n## Bivariado cualitativo\n\n### Cálculo de frecuencias\n\nLas tablas de doble entrada tiene su nombre porque en las columnas entran los valores de una variable categórica, y en las filas de una segunda. Basicamente es como hacer un conteo de todas las combinaciones posibles entre los valores de una variable con la otra.\n\nPor ejemplo, si quisiéramos combinar las dos variables que ya estudiamos lo podemos hacer, con una tabla de doble entrada:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  mutate(clase_hog=as_label(clase_hog)) %>% \n  mutate(sexo_jefe=as_label(sexo_jefe)) %>% # para que las lea como factor\n                tabyl(clase_hog, sexo_jefe, show_missing_levels=F ) %>% # incluimos aquí \n                adorn_totals()  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n clase_hog     1     2\n         1  6010  4832\n         2 43151 12188\n         3 13410  8409\n         4   477   240\n         5   182   107\n     Total 63230 25776\n```\n:::\n:::\n\n\nObservamos que en cada celda confluyen los casos que comparten las mismas características:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>%   \n    count(clase_hog==1 & sexo_jefe==1) # nos da la segunda celda de la izquierda\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  `clase_hog == 1 & sexo_jefe == 1`     n\n  <lgl>                             <int>\n1 FALSE                             82996\n2 TRUE                               6010\n```\n:::\n:::\n\n\n### Totales y porcentajes\n\nDe esta manera se colocan todos los datos. Si observa al poner la función \"adorn_totals()\" lo agregó como una nueva fila de totales, pero también podemos pedirle que agregue una columna de totales.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  mutate(clase_hog=as_label(clase_hog)) %>% \n  mutate(sexo_jefe=as_label(sexo_jefe)) %>% # para que las lea como factor\n  tabyl(clase_hog, sexo_jefe, show_missing_levels=F ) %>% # incluimos aquí dos variables\n  adorn_totals(\"col\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n clase_hog     1     2 Total\n         1  6010  4832 10842\n         2 43151 12188 55339\n         3 13410  8409 21819\n         4   477   240   717\n         5   182   107   289\n```\n:::\n:::\n\n\nO bien agregar los dos, introduciendo en el argumento \"c(\"col\", \"row\")\" un vector de caracteres de las dos opciones requeridas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  mutate(clase_hog=as_label(clase_hog)) %>% \n  mutate(sexo_jefe=as_label(sexo_jefe)) %>% # para que las lea como factor\n  tabyl(clase_hog, sexo_jefe, show_missing_levels=F ) %>% # incluimos aquí dos variable\n  adorn_totals(c(\"col\", \"row\")) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n clase_hog     1     2 Total\n         1  6010  4832 10842\n         2 43151 12188 55339\n         3 13410  8409 21819\n         4   477   240   717\n         5   182   107   289\n     Total 63230 25776 89006\n```\n:::\n:::\n\n\nDel mismo modo, podemos calcular los porcentajes. Pero los podemos calcular de tres formas. Uno es que lo calculemos para los totales calculados para las filas, para las columnas o para el gran total poblacional.\n\nPara columnas tenemos el siguiente código y los siguientes resultados:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  mutate(clase_hog=as_label(clase_hog)) %>% \n  mutate(sexo_jefe=as_label(sexo_jefe)) %>% # para que las lea como factor\n  tabyl(clase_hog, sexo_jefe, show_missing_levels=F ) %>% # incluimos aquí dos variable\n  adorn_totals(c(\"col\", \"row\")) %>% \n  adorn_percentages(\"col\") %>% # Divide los valores entre el total de la columna\n  adorn_pct_formatting() # lo vuelve porcentaje\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n clase_hog      1      2  Total\n         1   9.5%  18.7%  12.2%\n         2  68.2%  47.3%  62.2%\n         3  21.2%  32.6%  24.5%\n         4   0.8%   0.9%   0.8%\n         5   0.3%   0.4%   0.3%\n     Total 100.0% 100.0% 100.0%\n```\n:::\n:::\n\n\nCuando se hagan cuadros de distribuciones (que todas sus partes suman 100), los porcentajes pueden ser una gran ayuda para la interpretación, sobre todos cuando se comparar poblaciones de categorías de diferente tamaño. Por lo general, queremos que los cuadros nos den información de donde están los totales y su 100%, de esta manera el lector se puede guiar de porcentaje con respecto a qué está leyendo. En este caso, vemos que el 100% es común en la última fila.\n\nVeamos la diferencia de cómo podemos leer la misma celda, pero hoy, hemos calculado los porcentajes a nivel de fila:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  mutate(clase_hog=as_label(clase_hog)) %>% \n  mutate(sexo_jefe=as_label(sexo_jefe)) %>% # para que las lea como factor\n  tabyl(clase_hog, sexo_jefe, show_missing_levels=F ) %>% # incluimos aquí dos variable\n  adorn_totals(c(\"col\", \"row\")) %>% \n  adorn_percentages(\"row\") %>% # Divide los valores entre el total de la fila\n  adorn_pct_formatting() # lo vuelve porcentaje\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n clase_hog     1     2  Total\n         1 55.4% 44.6% 100.0%\n         2 78.0% 22.0% 100.0%\n         3 61.5% 38.5% 100.0%\n         4 66.5% 33.5% 100.0%\n         5 63.0% 37.0% 100.0%\n     Total 71.0% 29.0% 100.0%\n```\n:::\n:::\n\n\nFinalmente, podemos calcular los porcentajes con referencia a la población total en análisis. Es decir la celda en la esquina inferior derecha de nuestra tabla original.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  mutate(clase_hog=as_label(clase_hog)) %>% \n  mutate(sexo_jefe=as_label(sexo_jefe)) %>% # para que las lea como factor\n  tabyl(clase_hog, sexo_jefe, show_missing_levels=F ) %>% # incluimos aquí dos variable\n  adorn_totals(c(\"col\", \"row\")) %>% \n  adorn_percentages(\"all\") %>% # Divide los valores entre el total de la población\n  adorn_pct_formatting() # lo vuelve porcentaje\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n clase_hog     1     2  Total\n         1  6.8%  5.4%  12.2%\n         2 48.5% 13.7%  62.2%\n         3 15.1%  9.4%  24.5%\n         4  0.5%  0.3%   0.8%\n         5  0.2%  0.1%   0.3%\n     Total 71.0% 29.0% 100.0%\n```\n:::\n:::\n\n\n## Descriptivos para variables cuantitativas\n\nVamos a empezar a revisar los gráficos para variables cuantitativas.\n\n### Medidas numéricas básicas\n\n5 números\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(concentrado2020$ing_cor) ## ingresos\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n       0    21392    35172    47838    57640 10702107 \n```\n:::\n:::\n\n\nCon pipes se pueden crear \"indicadores\" de nuestras variables es un tibble\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  summarise(nombre_indicador=mean(ing_cor, na.rm=T))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  nombre_indicador\n             <dbl>\n1           47838.\n```\n:::\n:::\n\n\n### Histograma básico\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(concentrado2020$ing_cor)\n```\n\n::: {.cell-output-display}\n![](P3_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\nLe podemos modificar el título del eje de las x y de las y\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(concentrado2020$ing_cor, \n     main=\"Histograma de los ingresos corrientes\", \n     xlab=\"pesos mexicanos\", ylab=\"Frecuencia\") \n```\n\n::: {.cell-output-display}\n![](P3_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n¡A ponerle colorcitos! Aquí hay una lista <http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(concentrado2020$ing_cor, \n     main=\"Histograma de los ingresos corrientes\", \n     xlab=\"pesos mexicanos\", ylab=\"Frecuencia\",\n     col=\"deeppink1\") \n```\n\n::: {.cell-output-display}\n![](P3_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\nCon pipes:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n    with(hist(ing_cor)) # con with, para que entienda\n```\n\n::: {.cell-output-display}\n![](P3_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\nCuando usamos pipes, se debe de recordar que no es necesario escribir el nombre del data.frame en el filtro porque es lo primero que colocamos en nuestro \"pipe\".\n\nCheca que cualquier aditamiento debe ir en el pipe donde está el comando de hist(). Ten cuidado con los paréntesis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcentrado2020 %>% \n  filter(!is.na(ing_cor)) %>% # la ventaja de esta forma es que podemos hacer más operaciones\n    with(hist(ing_cor, main= \"histograma\"))\n```\n\n::: {.cell-output-display}\n![](P3_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "P3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}