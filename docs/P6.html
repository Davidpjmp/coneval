<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.163">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R para el monitoreo de la política de desarrollo social - 6&nbsp; Funciones, condicionales, bucles y mapeos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./P5.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Funciones, condicionales, bucles y mapeos</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R para el monitoreo de la política de desarrollo social</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introducción al curso</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./instala.html" class="sidebar-item-text sidebar-link">Instalación de R y Rstudio</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Primer acercamiento al uso del programa</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Manejo de datos: importación, selección y revisión</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Análisis descriptivo básico</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Factores de expansión y algunas otras medidas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fusionado de conjuntos de datos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P6.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Funciones, condicionales, bucles y mapeos</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#paquetes" id="toc-paquetes" class="nav-link active" data-scroll-target="#paquetes"><span class="toc-section-number">6.1</span>  Paquetes</a></li>
  <li><a href="#datos" id="toc-datos" class="nav-link" data-scroll-target="#datos"><span class="toc-section-number">6.2</span>  Datos</a></li>
  <li><a href="#mi-primera-función" id="toc-mi-primera-función" class="nav-link" data-scroll-target="#mi-primera-función"><span class="toc-section-number">6.3</span>  Mi primera función</a></li>
  <li><a href="#una-función-para-hacer-edades" id="toc-una-función-para-hacer-edades" class="nav-link" data-scroll-target="#una-función-para-hacer-edades"><span class="toc-section-number">6.4</span>  Una función para hacer edades</a></li>
  <li><a href="#bucles" id="toc-bucles" class="nav-link" data-scroll-target="#bucles"><span class="toc-section-number">6.5</span>  Bucles</a>
  <ul class="collapse">
  <li><a href="#for" id="toc-for" class="nav-link" data-scroll-target="#for"><span class="toc-section-number">6.5.1</span>  <code>for</code></a></li>
  <li><a href="#while" id="toc-while" class="nav-link" data-scroll-target="#while"><span class="toc-section-number">6.5.2</span>  <code>while()</code></a></li>
  </ul></li>
  <li><a href="#condicionales" id="toc-condicionales" class="nav-link" data-scroll-target="#condicionales"><span class="toc-section-number">6.6</span>  Condicionales</a></li>
  <li><a href="#purrrmap" id="toc-purrrmap" class="nav-link" data-scroll-target="#purrrmap"><span class="toc-section-number">6.7</span>  <code>purrr::map()</code></a></li>
  <li><a href="#combinando-funciones-con-purrmap" id="toc-combinando-funciones-con-purrmap" class="nav-link" data-scroll-target="#combinando-funciones-con-purrmap"><span class="toc-section-number">6.8</span>  Combinando funciones con purr::map</a></li>
  <li><a href="#una-aplicación-para-exportar-los-resultados-de-una-base" id="toc-una-aplicación-para-exportar-los-resultados-de-una-base" class="nav-link" data-scroll-target="#una-aplicación-para-exportar-los-resultados-de-una-base"><span class="toc-section-number">6.9</span>  Una aplicación para exportar los resultados de una base</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Funciones, condicionales, bucles y mapeos</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="paquetes" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="paquetes"><span class="header-section-number">6.1</span> Paquetes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)<span class="co">#instala pacman si se requiere</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               readxl,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               writexl, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               haven,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               sjlabelled, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>               janitor,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>               magrittr,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>               broom <span class="co"># para limpiar resultados de modelos</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="datos" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="datos"><span class="header-section-number">6.2</span> Datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>concentrado2020 <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"datos/concentrado2020.dta"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(sexo_jefe, clase_hog, educa_jefe), as.numeric)) <span class="sc">%&gt;%</span> <span class="co"># ojo aquí</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_labels</span>(sexo_jefe, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_labels</span>(clase_hog, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"unipersonal"</span>,<span class="st">"nuclear"</span>, <span class="st">"ampliado"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"compuesto"</span>,<span class="st">"corresidente"</span>))   <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_labels</span>(educa_jefe,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Sin instrucción"</span>, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Preescolar"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Primaria incompleta"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Primaria completa"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Secundaria incompleta"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Secundaria completa"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Preparatoria incompleta"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Preparatoria completa"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Profesional incompleta"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Profesional completa"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Posgrado"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ent=</span>stringr<span class="sc">::</span><span class="fu">str_sub</span>(ubica_geo, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mun=</span>stringr<span class="sc">::</span><span class="fu">str_sub</span>(ubica_geo, <span class="at">start =</span> <span class="dv">3</span>, <span class="at">end =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mi-primera-función" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="mi-primera-función"><span class="header-section-number">6.3</span> Mi primera función</h2>
<p>Unos de los elementos más poderosos de R es hacer nuestra propias funciones.</p>
<p>La lógica de las funciones es la siguiente:</p>
<pre><code>nombre_de_funcion(argumento1, argumento2, ...) {
  operaciones
  salida
}</code></pre>
<p>Para ello haremos una función sencilla. Para sumarle un valor un 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mi_funcion<span class="ot">&lt;-</span><span class="cf">function</span>(x) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    resultado<span class="ot">&lt;-</span>x<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(resultado)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mi_funcion</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>Vamos a agregar un argumento, podemos agregar un segundo número en lugar de 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mi_funcion<span class="ot">&lt;-</span><span class="cf">function</span>(x, a) {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    resultado<span class="ot">&lt;-</span>x<span class="sc">+</span>a</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(resultado)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mi_funcion</span>(<span class="at">x=</span><span class="dv">5</span>, <span class="at">a=</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
</div>
<p>Los argumentos no necesariamente deben ser un sólo valor</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mi_funcion</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">a=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7  9 11 13 15</code></pre>
</div>
</div>
<p>E incluso podríamos llamar variables de nuestra base de concentrado</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>resultado_mi_funcion<span class="ot">&lt;-</span><span class="fu">mi_funcion</span>(<span class="at">x=</span>concentrado2020<span class="sc">$</span>frutas, <span class="at">a=</span>concentrado2020<span class="sc">$</span>azucar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="una-función-para-hacer-edades" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="una-función-para-hacer-edades"><span class="header-section-number">6.4</span> Una función para hacer edades</h2>
<p>Primero un poquito de <code>pretty()</code> {base}, es un comando que calcula una secuencia de aproximadamente n+1 valores ‘redondos’ igualmente espaciados que cubran el rango de los valores en x. Los valores se eligen para que sean 1, 2 o 5 veces una potencia de 10.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cortar <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cut</span>(x,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">pretty</span>(x), </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">right =</span> <span class="cn">TRUE</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cortar(concentrado2020$edad_jefe)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Podemos utilizarla junto con mutate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>concentrado2020 <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eda_cut=</span><span class="fu">cortar</span>(edad_jefe)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(eda_cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   eda_cut     n      percent
    [0,20]   539 0.0060557715
   (20,40] 24896 0.2797114801
   (40,60] 38634 0.4340606251
   (60,80] 21301 0.2393209447
  (80,100]  3627 0.0407500618
 (100,120]     9 0.0001011168</code></pre>
</div>
</div>
</section>
<section id="bucles" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="bucles"><span class="header-section-number">6.5</span> Bucles</h2>
<section id="for" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="for"><span class="header-section-number">6.5.1</span> <code>for</code></h3>
<p>Supongamos que quisiéramos repetir una operación a lo largo de una secuencia, se puede realizar</p>
<pre><code>for (i in secuencia) {
  operación 1
  operación 2
  ...
  operación final
}
</code></pre>
<p>Por ejemplo si quisiéramos que por cada entidad federativa se imprimiera en pantalla el promedio de la edad de los jefes entrevistados</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(concentrado2020<span class="sc">$</span>ent) <span class="co"># Nos dan los valores únicos de un vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "01" "02" "03" "04" "05" "06" "07" "08" "09" "10" "11" "12" "13" "14" "15"
[16] "16" "17" "18" "19" "20" "21" "22" "23" "24" "25" "26" "27" "28" "29" "30"
[31] "31" "32"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>estados<span class="ot">&lt;-</span><span class="fu">unique</span>(concentrado2020<span class="sc">$</span>ent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hoy haremos nuestro bucle con “for”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> estados){</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>concentrado2020 <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ent<span class="sc">==</span>i) <span class="sc">%&gt;%</span> <span class="co"># aquí ocupamos nuestro indice</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">media=</span><span class="fu">mean</span>(ing_cor))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"ingreso"</span>,i), x)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vamos a botar estos objetos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(, <span class="at">pattern =</span> <span class="st">"ingreso"</span>)) </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="while" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="while"><span class="header-section-number">6.5.2</span> <code>while()</code></h3>
<p>También tenemos <code>while()</code></p>
<pre><code>while (expresión a probar) {
  Operaciones
}</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variable que se cambia</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>numero <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># variable donde se calcula la meida</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la suma consecutiva hasta que llegue a 30</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(numero <span class="sc">&lt;=</span> <span class="dv">30</span>) {</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate sum</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  sum <span class="ot">=</span> sum <span class="sc">+</span> numero</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># increment number by 1</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  numero <span class="ot">=</span> numero <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="condicionales" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="condicionales"><span class="header-section-number">6.6</span> Condicionales</h2>
<p>Las operaciones están supeditadas a los elementos que cumplan una condición</p>
<pre><code>if (condicion) {
  operación 1
  operación 2
  ...
  operación final
}</code></pre>
<p>Supongamos tenemos dos valores</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">45</span> <span class="co"># un vector entero</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">5000</span> <span class="co">#numeros aleatorios que siguen una normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Veamos cómo podemos hacer un condicional muy simple</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(a<span class="sc">&gt;</span><span class="dv">18</span>){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(b)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5000</code></pre>
</div>
</div>
<p>También se puede combinar con else</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(a<span class="sc">&gt;</span><span class="dv">18</span>){</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Mayor que 18"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No cumple"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mayor que 18"</code></pre>
</div>
</div>
<p>Estos elementos funcionan cuando se programan procesos. Son útiles para cuando computamos modelos y se busca cierto nivel de tolerancia o se hacen procesos sucesivos.</p>
</section>
<section id="purrrmap" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="purrrmap"><span class="header-section-number">6.7</span> <code>purrr::map()</code></h2>
<p>Dentro de tidyverse existe el paquete <code>{purrr}</code>, es un paquete que tiene muchas funcionalidades parecidas a los <code>for</code>.</p>
<p>Por ejemplo y siguiendo los ejemplos del for()</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span>.x<span class="sc">+</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 2

[[2]]
[1] 3

[[3]]
[1] 4

[[4]]
[1] 5

[[5]]
[1] 6

[[6]]
[1] 7

[[7]]
[1] 8

[[8]]
[1] 9

[[9]]
[1] 10

[[10]]
[1] 11</code></pre>
</div>
</div>
<p>Si guardamos esto en un objeto, vemos que nos da como resultado una lista</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>map1<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span>.x<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(map1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
<p>Compliquemos esto un poquito más…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(concentrado2020) <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_chr</span>(<span class="sc">~</span><span class="fu">str_detect</span>(.x,<span class="st">"ing"</span>)) <span class="co"># ojo a veces tenemos que hacer explícito el tipo de mapeo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
 [10] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
 [19] "FALSE" "FALSE" "TRUE"  "FALSE" "TRUE"  "TRUE"  "FALSE" "FALSE" "FALSE"
 [28] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
 [37] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
 [46] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
 [55] "FALSE" "TRUE"  "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
 [64] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
 [73] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
 [82] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
 [91] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
[100] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
[109] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
[118] "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE" "FALSE"
[127] "FALSE" "FALSE"</code></pre>
</div>
</div>
<p>Por ejemplo, quizás queremos identificar esta base de datos con 2020</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(concentrado2020) <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_chr</span>(<span class="sc">~</span><span class="fu">paste0</span>(.x,<span class="st">"2020"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "folioviv2020"   "foliohog2020"   "ubica_geo2020"  "tam_loc2020"   
  [5] "est_socio2020"  "est_dis2020"    "upm2020"        "factor2020"    
  [9] "clase_hog2020"  "sexo_jefe2020"  "edad_jefe2020"  "educa_jefe2020"
 [13] "tot_integ2020"  "hombres2020"    "mujeres2020"    "mayores2020"   
 [17] "menores2020"    "p12_642020"     "p65mas2020"     "ocupados2020"  
 [21] "percep_ing2020" "perc_ocupa2020" "ing_cor2020"    "ingtrab2020"   
 [25] "trabajo2020"    "sueldos2020"    "horas_extr2020" "comisiones2020"
 [29] "aguinaldo2020"  "indemtrab2020"  "otra_rem2020"   "remu_espec2020"
 [33] "negocio2020"    "noagrop2020"    "industria2020"  "comercio2020"  
 [37] "servicios2020"  "agrope2020"     "agricolas2020"  "pecuarios2020" 
 [41] "reproducc2020"  "pesca2020"      "otros_trab2020" "rentas2020"    
 [45] "utilidad2020"   "arrenda2020"    "transfer2020"   "jubilacion2020"
 [49] "becas2020"      "donativos2020"  "remesas2020"    "bene_gob2020"  
 [53] "transf_hog2020" "trans_inst2020" "estim_alqu2020" "otros_ing2020" 
 [57] "gasto_mon2020"  "alimentos2020"  "ali_dentro2020" "cereales2020"  
 [61] "carnes2020"     "pescado2020"    "leche2020"      "huevo2020"     
 [65] "aceites2020"    "tuberculo2020"  "verduras2020"   "frutas2020"    
 [69] "azucar2020"     "cafe2020"       "especias2020"   "otros_alim2020"
 [73] "bebidas2020"    "ali_fuera2020"  "tabaco2020"     "vesti_calz2020"
 [77] "vestido2020"    "calzado2020"    "vivienda2020"   "alquiler2020"  
 [81] "pred_cons2020"  "agua2020"       "energia2020"    "limpieza2020"  
 [85] "cuidados2020"   "utensilios2020" "enseres2020"    "salud2020"     
 [89] "atenc_ambu2020" "hospital2020"   "medicinas2020"  "transporte2020"
 [93] "publico2020"    "foraneo2020"    "adqui_vehi2020" "mantenim2020"  
 [97] "refaccion2020"  "combus2020"     "comunica2020"   "educa_espa2020"
[101] "educacion2020"  "esparci2020"    "paq_turist2020" "personales2020"
[105] "cuida_pers2020" "acces_pers2020" "otros_gas2020"  "transf_gas2020"
[109] "percep_tot2020" "retiro_inv2020" "prestamos2020"  "otras_perc2020"
[113] "ero_nm_viv2020" "ero_nm_hog2020" "erogac_tot2020" "cuota_viv2020" 
[117] "mater_serv2020" "material2020"   "servicio2020"   "deposito2020"  
[121] "prest_terc2020" "pago_tarje2020" "deudas2020"     "balance2020"   
[125] "otras_erog2020" "smg2020"        "ent2020"        "mun2020"       </code></pre>
</div>
</div>
<p>Con estos nuevos nombres podríamos rápidamente volver a declarar nuestros nombres de la base y todos tienen sufijos.</p>
<p>Combinación con el comando <code>split()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>concentrado2020 <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>ent) <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">mean</span>(.<span class="sc">$</span>ing_cor)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`01`
[1] 55597.85

$`02`
[1] 62025.77

$`03`
[1] 61035.48

$`04`
[1] 46077.36

$`05`
[1] 52229.66

$`06`
[1] 51344.63

$`07`
[1] 29010.53

$`08`
[1] 57482.27

$`09`
[1] 60073.04

$`10`
[1] 46701.09

$`11`
[1] 43968.91

$`12`
[1] 31403.23

$`13`
[1] 39114.3

$`14`
[1] 54199.69

$`15`
[1] 42418.68

$`16`
[1] 45058.28

$`17`
[1] 40308.1

$`18`
[1] 52299.53

$`19`
[1] 57441.94

$`20`
[1] 33983.13

$`21`
[1] 37504.67

$`22`
[1] 53929.64

$`23`
[1] 42746.02

$`24`
[1] 43422.68

$`25`
[1] 57210.55

$`26`
[1] 56762.87

$`27`
[1] 40997.84

$`28`
[1] 46989.76

$`29`
[1] 37484.91

$`30`
[1] 32470.97

$`31`
[1] 39977.85

$`32`
[1] 43811.06</code></pre>
</div>
</div>
<p>Nos da una lista de valores… si hacemos algo más complejo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>concentrado2020 <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>ent) <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">mean</span>(.<span class="sc">$</span>ing_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="sc">~</span><span class="fu">as.data.frame</span>(.x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         .x
1  55597.85
2  62025.77
3  61035.48
4  46077.36
5  52229.66
6  51344.63
7  29010.53
8  57482.27
9  60073.04
10 46701.09
11 43968.91
12 31403.23
13 39114.30
14 54199.69
15 42418.68
16 45058.28
17 40308.10
18 52299.53
19 57441.94
20 33983.13
21 37504.67
22 53929.64
23 42746.02
24 43422.68
25 57210.55
26 56762.87
27 40997.84
28 46989.76
29 37484.91
30 32470.97
31 39977.85
32 43811.06</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>concentrado2020 <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>ent) <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">mean</span>(.<span class="sc">$</span>ing_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfc</span>(<span class="sc">~</span><span class="fu">as.data.frame</span>(.x)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `.x` -&gt; `.x...1`
• `.x` -&gt; `.x...2`
• `.x` -&gt; `.x...3`
• `.x` -&gt; `.x...4`
• `.x` -&gt; `.x...5`
• `.x` -&gt; `.x...6`
• `.x` -&gt; `.x...7`
• `.x` -&gt; `.x...8`
• `.x` -&gt; `.x...9`
• `.x` -&gt; `.x...10`
• `.x` -&gt; `.x...11`
• `.x` -&gt; `.x...12`
• `.x` -&gt; `.x...13`
• `.x` -&gt; `.x...14`
• `.x` -&gt; `.x...15`
• `.x` -&gt; `.x...16`
• `.x` -&gt; `.x...17`
• `.x` -&gt; `.x...18`
• `.x` -&gt; `.x...19`
• `.x` -&gt; `.x...20`
• `.x` -&gt; `.x...21`
• `.x` -&gt; `.x...22`
• `.x` -&gt; `.x...23`
• `.x` -&gt; `.x...24`
• `.x` -&gt; `.x...25`
• `.x` -&gt; `.x...26`
• `.x` -&gt; `.x...27`
• `.x` -&gt; `.x...28`
• `.x` -&gt; `.x...29`
• `.x` -&gt; `.x...30`
• `.x` -&gt; `.x...31`
• `.x` -&gt; `.x...32`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       x_1      x_2      x_3      x_4      x_5      x_6      x_7      x_8
1 55597.85 62025.77 61035.48 46077.36 52229.66 51344.63 29010.53 57482.27
       x_9     x_10     x_11     x_12    x_13     x_14     x_15     x_16
1 60073.04 46701.09 43968.91 31403.23 39114.3 54199.69 42418.68 45058.28
     x_17     x_18     x_19     x_20     x_21     x_22     x_23     x_24
1 40308.1 52299.53 57441.94 33983.13 37504.67 53929.64 42746.02 43422.68
      x_25     x_26     x_27     x_28     x_29     x_30     x_31     x_32
1 57210.55 56762.87 40997.84 46989.76 37484.91 32470.97 39977.85 43811.06</code></pre>
</div>
</div>
</section>
<section id="combinando-funciones-con-purrmap" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="combinando-funciones-con-purrmap"><span class="header-section-number">6.8</span> Combinando funciones con purr::map</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>mi_funcion_summ<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  mu<span class="ot">&lt;-</span><span class="fu">mean</span>(x, <span class="at">na.rm=</span>T)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  me<span class="ot">&lt;-</span><span class="fu">median</span>(x,<span class="at">na.rm=</span>T)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  sd<span class="ot">&lt;-</span><span class="fu">sd</span>(x,<span class="at">na.rm=</span>T)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  total<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(mu,me,sd))</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(total)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mi_funcion_summ</span>(concentrado2020<span class="sc">$</span>ing_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        mu       me       sd
1 47838.49 35172.01 71276.03</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>concentrado2020 <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>ent) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">mi_funcion_summ</span>(.<span class="sc">$</span>ing_cor)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`01`
        mu       me       sd
1 55597.85 43010.77 47117.57

$`02`
        mu       me       sd
1 62025.77 45830.24 88387.62

$`03`
        mu       me       sd
1 61035.48 46770.46 53076.37

$`04`
        mu       me       sd
1 46077.36 32571.64 44224.74

$`05`
        mu       me       sd
1 52229.66 40902.97 43428.09

$`06`
        mu       me       sd
1 51344.63 40101.63 45501.34

$`07`
        mu      me       sd
1 29010.53 20903.2 28774.17

$`08`
        mu      me       sd
1 57482.27 38987.7 192053.2

$`09`
        mu       me       sd
1 60073.04 44900.21 57306.15

$`10`
        mu       me       sd
1 46701.09 34080.83 129188.6

$`11`
        mu       me       sd
1 43968.91 34721.14 34355.33

$`12`
        mu       me       sd
1 31403.23 22612.42 29169.38

$`13`
       mu       me       sd
1 39114.3 30099.82 32567.11

$`14`
        mu       me       sd
1 54199.69 41576.07 65377.82

$`15`
        mu       me       sd
1 42418.68 32016.39 53796.92

$`16`
        mu       me      sd
1 45058.28 34874.98 42919.1

$`17`
       mu       me       sd
1 40308.1 30620.45 37761.98

$`18`
        mu       me       sd
1 52299.53 41207.48 47639.84

$`19`
        mu       me       sd
1 57441.94 41690.93 82230.47

$`20`
        mu       me       sd
1 33983.13 23870.17 35229.34

$`21`
        mu      me       sd
1 37504.67 27817.3 43038.53

$`22`
        mu       me       sd
1 53929.64 41330.98 50918.38

$`23`
        mu       me       sd
1 42746.02 31730.53 50819.97

$`24`
        mu       me       sd
1 43422.68 31982.96 44543.01

$`25`
        mu       me       sd
1 57210.55 44418.12 49915.59

$`26`
        mu       me       sd
1 56762.87 41258.91 58032.84

$`27`
        mu       me       sd
1 40997.84 28915.12 40031.89

$`28`
        mu       me       sd
1 46989.76 34504.18 71032.01

$`29`
        mu       me       sd
1 37484.91 28347.77 31704.41

$`30`
        mu       me       sd
1 32470.97 24270.49 28210.82

$`31`
        mu       me       sd
1 39977.85 28836.27 48809.08

$`32`
        mu       me       sd
1 43811.06 30948.86 87282.28</code></pre>
</div>
</div>
<p>Lo interesante es que podemos hacer elementos más complejos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>concentrado2020 <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>ent) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">lm</span>(ing_cor <span class="sc">~</span> edad_jefe, <span class="at">data =</span> .))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`01`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    50487.3        102.3  


$`02`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    50224.7        242.9  


$`03`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    47835.8        272.7  


$`04`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   43159.93        58.73  


$`05`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   54785.09       -49.81  


$`06`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   56096.00       -91.26  


$`07`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    20136.7        176.6  


$`08`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   61557.56       -80.51  


$`09`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    44275.9        298.1  


$`10`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
  46293.749        7.807  


$`11`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   45856.40       -36.74  


$`12`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   27045.90        83.79  


$`13`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   42109.48       -57.72  


$`14`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    55515.6        -25.5  


$`15`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
      34668          153  


$`16`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   48426.93       -65.55  


$`17`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    34578.9        108.6  


$`18`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   48185.84        79.67  


$`19`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   54543.93        54.53  


$`20`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
  33477.567        9.767  


$`21`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    29022.5        165.9  


$`22`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    47429.7        132.4  


$`23`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   42180.99        11.98  


$`24`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    49118.0       -107.9  


$`25`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   61909.90       -89.92  


$`26`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   60217.11       -66.49  


$`27`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    34146.3        137.4  


$`28`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    53207.3       -122.3  


$`29`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    30845.1        129.9  


$`30`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
    28875.7         68.8  


$`31`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   37261.74        53.66  


$`32`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Coefficients:
(Intercept)    edad_jefe  
   39369.04        84.65  </code></pre>
</div>
</div>
<p>Y el mapeo se puede ir agregando…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>concentrado2020 <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>ent) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">lm</span>(ing_cor <span class="sc">~</span> edad_jefe, <span class="at">data =</span> .)) <span class="sc">%&gt;%</span> <span class="co"># da solo los coeficientes</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(summary) <span class="co"># da la parte de inferencia</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`01`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-53847 -27740 -12184  12656 641581 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 50487.33    3042.99   16.59   &lt;2e-16 ***
edad_jefe     102.33      58.13    1.76   0.0785 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 47100 on 2667 degrees of freedom
Multiple R-squared:  0.00116,   Adjusted R-squared:  0.000786 
F-statistic: 3.099 on 1 and 2667 DF,  p-value: 0.07847


$`02`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -62786  -32386  -15760   10565 3881875 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 50224.74    4607.58  10.900  &lt; 2e-16 ***
edad_jefe     242.91      90.54   2.683  0.00733 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 88320 on 4140 degrees of freedom
Multiple R-squared:  0.001736,  Adjusted R-squared:  0.001495 
F-statistic: 7.198 on 1 and 4140 DF,  p-value: 0.007326


$`03`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-68291 -30773 -13592  13727 639588 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 47835.79    3375.53   14.17  &lt; 2e-16 ***
edad_jefe     272.73      66.52    4.10 4.25e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 52920 on 2715 degrees of freedom
Multiple R-squared:  0.006154,  Adjusted R-squared:  0.005788 
F-statistic: 16.81 on 1 and 2715 DF,  p-value: 4.248e-05


$`04`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-45027 -26185 -13443  10044 536634 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 43159.93    3248.67  13.285   &lt;2e-16 ***
edad_jefe      58.73      62.55   0.939    0.348    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 44230 on 2172 degrees of freedom
Multiple R-squared:  0.0004057, Adjusted R-squared:  -5.448e-05 
F-statistic: 0.8816 on 1 and 2172 DF,  p-value: 0.3479


$`05`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-50161 -27149 -11519  11967 527608 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 54785.09    2348.34  23.329   &lt;2e-16 ***
edad_jefe     -49.81      43.73  -1.139    0.255    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 43430 on 3920 degrees of freedom
Multiple R-squared:  0.0003308, Adjusted R-squared:  7.581e-05 
F-statistic: 1.297 on 1 and 3920 DF,  p-value: 0.2548


$`06`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-50026 -26169 -11367  11829 673149 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 56096.00    2654.84  21.130   &lt;2e-16 ***
edad_jefe     -91.26      48.66  -1.876   0.0608 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 45480 on 3280 degrees of freedom
Multiple R-squared:  0.001071,  Adjusted R-squared:  0.0007668 
F-statistic: 3.518 on 1 and 3280 DF,  p-value: 0.06081


$`07`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-30674 -15430  -7650   4600 358554 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 20136.69    2038.61   9.878  &lt; 2e-16 ***
edad_jefe     176.55      38.63   4.571 5.14e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 28640 on 2121 degrees of freedom
Multiple R-squared:  0.009753,  Adjusted R-squared:  0.009286 
F-statistic: 20.89 on 1 and 2121 DF,  p-value: 5.145e-06


$`08`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
     Min       1Q   Median       3Q      Max 
  -56304   -33730   -18662     6192 10645058 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 61557.56    9397.99   6.550 6.39e-11 ***
edad_jefe     -80.51     176.98  -0.455    0.649    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 192100 on 4570 degrees of freedom
Multiple R-squared:  4.528e-05, Adjusted R-squared:  -0.0001735 
F-statistic: 0.2069 on 1 and 4570 DF,  p-value: 0.6492


$`09`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -65068  -31879  -15111   13622 1140796 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 44275.87    4045.96  10.943  &lt; 2e-16 ***
edad_jefe     298.14      73.34   4.065 4.94e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 57130 on 2568 degrees of freedom
Multiple R-squared:  0.006395,  Adjusted R-squared:  0.006008 
F-statistic: 16.53 on 1 and 2568 DF,  p-value: 4.941e-05


$`10`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -45690  -25672  -12659    7365 6360100 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 46293.749   8213.038   5.637 1.91e-08 ***
edad_jefe       7.807    150.147   0.052    0.959    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 129200 on 2744 degrees of freedom
Multiple R-squared:  9.852e-07, Adjusted R-squared:  -0.0003634 
F-statistic: 0.002703 on 1 and 2744 DF,  p-value: 0.9585


$`11`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-41277 -21865  -9269  10680 305297 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 45856.40    2038.40  22.496   &lt;2e-16 ***
edad_jefe     -36.74      37.80  -0.972    0.331    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 34360 on 3081 degrees of freedom
Multiple R-squared:  0.0003064, Adjusted R-squared:  -1.803e-05 
F-statistic: 0.9444 on 1 and 3081 DF,  p-value: 0.3312


$`12`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-32748 -17449  -8748   7167 233275 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 27045.90    1905.72  14.192   &lt;2e-16 ***
edad_jefe      83.79      34.88   2.402   0.0164 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 29140 on 2488 degrees of freedom
Multiple R-squared:  0.002314,  Adjusted R-squared:  0.001913 
F-statistic:  5.77 on 1 and 2488 DF,  p-value: 0.01638


$`13`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-38141 -19608  -9123   8407 380207 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 42109.48    2307.56  18.249   &lt;2e-16 ***
edad_jefe     -57.72      42.42  -1.361    0.174    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 32560 on 2211 degrees of freedom
Multiple R-squared:  0.0008366, Adjusted R-squared:  0.0003847 
F-statistic: 1.851 on 1 and 2211 DF,  p-value: 0.1738


$`14`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -51479  -26801  -12529   10973 1695965 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  55515.6     4069.4   13.64   &lt;2e-16 ***
edad_jefe      -25.5       75.1   -0.34    0.734    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 65390 on 2777 degrees of freedom
Multiple R-squared:  4.151e-05, Adjusted R-squared:  -0.0003186 
F-statistic: 0.1153 on 1 and 2777 DF,  p-value: 0.7342


$`15`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -44553  -21374  -10179    7495 2137811 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 34668.17    3179.52  10.904   &lt;2e-16 ***
edad_jefe     152.98      60.19   2.542   0.0111 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 53760 on 3566 degrees of freedom
Multiple R-squared:  0.001808,  Adjusted R-squared:  0.001528 
F-statistic:  6.46 on 1 and 3566 DF,  p-value: 0.01108


$`16`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-45469 -23107 -10431   9913 699833 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 48426.93    3050.94  15.873   &lt;2e-16 ***
edad_jefe     -65.55      56.42  -1.162    0.245    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 42920 on 2045 degrees of freedom
Multiple R-squared:  0.0006595, Adjusted R-squared:  0.0001708 
F-statistic:  1.35 on 1 and 2045 DF,  p-value: 0.2455


$`17`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-40444 -21067  -9525   8578 422100 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 34578.88    2498.64  13.839   &lt;2e-16 ***
edad_jefe     108.61      45.21   2.402   0.0164 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 37730 on 2562 degrees of freedom
Multiple R-squared:  0.002247,  Adjusted R-squared:  0.001858 
F-statistic: 5.771 on 1 and 2562 DF,  p-value: 0.01637


$`18`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-51372 -26788 -11200  10938 906914 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 48185.84    3461.34  13.921   &lt;2e-16 ***
edad_jefe      79.67      63.95   1.246    0.213    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 47630 on 2101 degrees of freedom
Multiple R-squared:  0.0007383, Adjusted R-squared:  0.0002626 
F-statistic: 1.552 on 1 and 2101 DF,  p-value: 0.2129


$`19`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -56829  -31122  -15660    8669 3248057 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 54543.93    4696.75  11.613   &lt;2e-16 ***
edad_jefe      54.53      84.42   0.646    0.518    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 82240 on 3500 degrees of freedom
Multiple R-squared:  0.0001192, Adjusted R-squared:  -0.0001665 
F-statistic: 0.4172 on 1 and 3500 DF,  p-value: 0.5184


$`20`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-32265 -19866 -10036   7954 618037 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 33477.567   2275.058  14.715   &lt;2e-16 ***
edad_jefe       9.767     41.872   0.233    0.816    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 35240 on 2594 degrees of freedom
Multiple R-squared:  2.097e-05, Adjusted R-squared:  -0.0003645 
F-statistic: 0.05441 on 1 and 2594 DF,  p-value: 0.8156


$`21`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -37459  -19716   -9087    6812 1298468 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 29022.51    3120.66   9.300  &lt; 2e-16 ***
edad_jefe     165.88      58.26   2.847  0.00446 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 42970 on 2139 degrees of freedom
Multiple R-squared:  0.003775,  Adjusted R-squared:  0.003309 
F-statistic: 8.106 on 1 and 2139 DF,  p-value: 0.004455


$`22`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -55242  -27383  -11991   11751 1049250 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 47429.67    2745.77  17.274   &lt;2e-16 ***
edad_jefe     132.41      53.32   2.483   0.0131 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 50880 on 3767 degrees of freedom
Multiple R-squared:  0.001634,  Adjusted R-squared:  0.001369 
F-statistic: 6.166 on 1 and 3767 DF,  p-value: 0.01307


$`23`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -42718  -23815  -10997    9207 1415545 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 42180.99    3707.87  11.376   &lt;2e-16 ***
edad_jefe      11.98      75.20   0.159    0.873    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 50830 on 2194 degrees of freedom
Multiple R-squared:  1.157e-05, Adjusted R-squared:  -0.0004442 
F-statistic: 0.0254 on 1 and 2194 DF,  p-value: 0.8734


$`24`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-41965 -25250 -11448  10590 898064 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 49118.03    2980.85  16.478   &lt;2e-16 ***
edad_jefe    -107.90      53.92  -2.001   0.0455 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 44520 on 2519 degrees of freedom
Multiple R-squared:  0.001587,  Adjusted R-squared:  0.001191 
F-statistic: 4.005 on 1 and 2519 DF,  p-value: 0.04548


$`25`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-55695 -28466 -12659  12536 923717 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 61909.90    2993.68  20.680   &lt;2e-16 ***
edad_jefe     -89.92      54.92  -1.638    0.102    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 49900 on 3427 degrees of freedom
Multiple R-squared:  0.0007818, Adjusted R-squared:  0.0004903 
F-statistic: 2.681 on 1 and 3427 DF,  p-value: 0.1016


$`26`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-55392 -31717 -15980  11905 931996 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 60217.11    4011.12  15.013   &lt;2e-16 ***
edad_jefe     -66.49      73.80  -0.901    0.368    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 58040 on 2418 degrees of freedom
Multiple R-squared:  0.0003356, Adjusted R-squared:  -7.779e-05 
F-statistic: 0.8118 on 1 and 2418 DF,  p-value: 0.3677


$`27`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-41568 -22640 -11534   8209 420041 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  34146.3     2993.3  11.407   &lt;2e-16 ***
edad_jefe      137.4       57.4   2.393   0.0168 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 39990 on 2086 degrees of freedom
Multiple R-squared:  0.002739,  Adjusted R-squared:  0.002261 
F-statistic: 5.729 on 1 and 2086 DF,  p-value: 0.01678


$`28`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -49294  -25381  -12421    7864 2384864 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  53207.3     4963.6  10.719   &lt;2e-16 ***
edad_jefe     -122.3       93.2  -1.312     0.19    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 71020 on 2309 degrees of freedom
Multiple R-squared:  0.000745,  Adjusted R-squared:  0.0003123 
F-statistic: 1.722 on 1 and 2309 DF,  p-value: 0.1896


$`29`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-36585 -18878  -8947   9074 290867 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 30845.14    2334.54  13.213  &lt; 2e-16 ***
edad_jefe     129.93      43.69   2.974  0.00298 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 31650 on 2157 degrees of freedom
Multiple R-squared:  0.004082,  Adjusted R-squared:  0.003621 
F-statistic: 8.842 on 1 and 2157 DF,  p-value: 0.002977


$`30`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-31570 -17104  -7854   6713 250230 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  28875.7     1842.2  15.675   &lt;2e-16 ***
edad_jefe       68.8       33.7   2.042   0.0413 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 28190 on 2715 degrees of freedom
Multiple R-squared:  0.001533,  Adjusted R-squared:  0.001165 
F-statistic: 4.168 on 1 and 2715 DF,  p-value: 0.04128


$`31`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -39137  -22567  -11025    6332 1454038 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 37261.74    3028.89   12.30   &lt;2e-16 ***
edad_jefe      53.66      57.08    0.94    0.347    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 48810 on 2887 degrees of freedom
Multiple R-squared:  0.000306,  Adjusted R-squared:  -4.032e-05 
F-statistic: 0.8836 on 1 and 2887 DF,  p-value: 0.3473


$`32`

Call:
lm(formula = ing_cor ~ edad_jefe, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
 -42383  -24463  -12794    7267 3189966 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 39369.04    5738.28   6.861  8.6e-12 ***
edad_jefe      84.65     104.17   0.813    0.417    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 87290 on 2502 degrees of freedom
Multiple R-squared:  0.0002638, Adjusted R-squared:  -0.0001358 
F-statistic: 0.6602 on 1 and 2502 DF,  p-value: 0.4166</code></pre>
</div>
</div>
<p>Si queremos esto en una sola base de datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>concentrado2020 <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>ent) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">lm</span>(ing_cor <span class="sc">~</span> edad_jefe, <span class="at">data =</span> .)) <span class="sc">%&gt;%</span> <span class="co"># da solo los coeficientes</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> broom<span class="sc">::</span><span class="fu">tidy</span>(.x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`01`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   50487.    3043.      16.6  6.53e-59
2 edad_jefe       102.      58.1      1.76 7.85e- 2

$`02`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   50225.    4608.      10.9  2.69e-27
2 edad_jefe       243.      90.5      2.68 7.33e- 3

$`03`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   47836.    3376.      14.2  4.92e-44
2 edad_jefe       273.      66.5      4.10 4.25e- 5

$`04`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  43160.     3249.     13.3   8.78e-39
2 edad_jefe       58.7      62.6     0.939 3.48e- 1

$`05`
# A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)  54785.     2348.      23.3  7.83e-113
2 edad_jefe      -49.8      43.7     -1.14 2.55e-  1

$`06`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  56096.     2655.      21.1  5.13e-93
2 edad_jefe      -91.3      48.7     -1.88 6.08e- 2

$`07`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   20137.    2039.       9.88 1.58e-22
2 edad_jefe       177.      38.6      4.57 5.14e- 6

$`08`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  61558.      9398.     6.55  6.39e-11
2 edad_jefe      -80.5      177.    -0.455 6.49e- 1

$`09`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   44276.    4046.      10.9  2.84e-27
2 edad_jefe       298.      73.3      4.07 4.94e- 5

$`10`
# A tibble: 2 × 5
  term        estimate std.error statistic      p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
1 (Intercept) 46294.       8213.    5.64   0.0000000191
2 edad_jefe       7.81      150.    0.0520 0.959       

$`11`
# A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)  45856.     2038.     22.5   6.80e-104
2 edad_jefe      -36.7      37.8    -0.972 3.31e-  1

$`12`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  27046.     1906.      14.2  5.12e-44
2 edad_jefe       83.8      34.9      2.40 1.64e- 2

$`13`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  42109.     2308.      18.2  2.05e-69
2 edad_jefe      -57.7      42.4     -1.36 1.74e- 1

$`14`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  55516.     4069.     13.6   4.59e-41
2 edad_jefe      -25.5      75.1    -0.340 7.34e- 1

$`15`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   34668.    3180.      10.9  2.97e-27
2 edad_jefe       153.      60.2      2.54 1.11e- 2

$`16`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  48427.     3051.      15.9  1.36e-53
2 edad_jefe      -65.5      56.4     -1.16 2.45e- 1

$`17`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   34579.    2499.      13.8  4.65e-42
2 edad_jefe       109.      45.2      2.40 1.64e- 2

$`18`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  48186.     3461.      13.9  3.32e-42
2 edad_jefe       79.7      63.9      1.25 2.13e- 1

$`19`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  54544.     4697.     11.6   1.28e-30
2 edad_jefe       54.5      84.4     0.646 5.18e- 1

$`20`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept) 33478.      2275.     14.7   3.89e-47
2 edad_jefe       9.77      41.9     0.233 8.16e- 1

$`21`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   29023.    3121.       9.30 3.35e-20
2 edad_jefe       166.      58.3      2.85 4.46e- 3

$`22`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   47430.    2746.      17.3  2.11e-64
2 edad_jefe       132.      53.3      2.48 1.31e- 2

$`23`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  42181.     3708.     11.4   3.55e-29
2 edad_jefe       12.0      75.2     0.159 8.73e- 1

$`24`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   49118.    2981.      16.5  5.16e-58
2 edad_jefe      -108.      53.9     -2.00 4.55e- 2

$`25`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  61910.     2994.      20.7  1.25e-89
2 edad_jefe      -89.9      54.9     -1.64 1.02e- 1

$`26`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  60217.     4011.     15.0   8.94e-49
2 edad_jefe      -66.5      73.8    -0.901 3.68e- 1

$`27`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   34146.    2993.      11.4  2.78e-29
2 edad_jefe       137.      57.4      2.39 1.68e- 2

$`28`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   53207.    4964.      10.7  3.37e-26
2 edad_jefe      -122.      93.2     -1.31 1.90e- 1

$`29`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   30845.    2335.      13.2  2.21e-38
2 edad_jefe       130.      43.7      2.97 2.98e- 3

$`30`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  28876.     1842.      15.7  4.44e-53
2 edad_jefe       68.8      33.7      2.04 4.13e- 2

$`31`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  37262.     3029.     12.3   6.15e-34
2 edad_jefe       53.7      57.1     0.940 3.47e- 1

$`32`
# A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  39369.      5738.     6.86  8.60e-12
2 edad_jefe       84.6      104.     0.813 4.17e- 1</code></pre>
</div>
</div>
<p>Como broom::tidy los volvio tibble, lo podemos guardar en un excelito</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>concentrado2020 <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>ent) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">lm</span>(ing_cor <span class="sc">~</span> edad_jefe, <span class="at">data =</span> .)) <span class="sc">%&gt;%</span> <span class="co"># da solo los coeficientes</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> broom<span class="sc">::</span><span class="fu">tidy</span>(.x)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_xlsx</span>(<span class="at">path=</span><span class="st">"modelos.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="una-aplicación-para-exportar-los-resultados-de-una-base" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="una-aplicación-para-exportar-los-resultados-de-una-base"><span class="header-section-number">6.9</span> Una aplicación para exportar los resultados de una base</h2>
<p>Veamos…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(concentrado2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "folioviv"   "foliohog"   "ubica_geo"  "tam_loc"    "est_socio" 
  [6] "est_dis"    "upm"        "factor"     "clase_hog"  "sexo_jefe" 
 [11] "edad_jefe"  "educa_jefe" "tot_integ"  "hombres"    "mujeres"   
 [16] "mayores"    "menores"    "p12_64"     "p65mas"     "ocupados"  
 [21] "percep_ing" "perc_ocupa" "ing_cor"    "ingtrab"    "trabajo"   
 [26] "sueldos"    "horas_extr" "comisiones" "aguinaldo"  "indemtrab" 
 [31] "otra_rem"   "remu_espec" "negocio"    "noagrop"    "industria" 
 [36] "comercio"   "servicios"  "agrope"     "agricolas"  "pecuarios" 
 [41] "reproducc"  "pesca"      "otros_trab" "rentas"     "utilidad"  
 [46] "arrenda"    "transfer"   "jubilacion" "becas"      "donativos" 
 [51] "remesas"    "bene_gob"   "transf_hog" "trans_inst" "estim_alqu"
 [56] "otros_ing"  "gasto_mon"  "alimentos"  "ali_dentro" "cereales"  
 [61] "carnes"     "pescado"    "leche"      "huevo"      "aceites"   
 [66] "tuberculo"  "verduras"   "frutas"     "azucar"     "cafe"      
 [71] "especias"   "otros_alim" "bebidas"    "ali_fuera"  "tabaco"    
 [76] "vesti_calz" "vestido"    "calzado"    "vivienda"   "alquiler"  
 [81] "pred_cons"  "agua"       "energia"    "limpieza"   "cuidados"  
 [86] "utensilios" "enseres"    "salud"      "atenc_ambu" "hospital"  
 [91] "medicinas"  "transporte" "publico"    "foraneo"    "adqui_vehi"
 [96] "mantenim"   "refaccion"  "combus"     "comunica"   "educa_espa"
[101] "educacion"  "esparci"    "paq_turist" "personales" "cuida_pers"
[106] "acces_pers" "otros_gas"  "transf_gas" "percep_tot" "retiro_inv"
[111] "prestamos"  "otras_perc" "ero_nm_viv" "ero_nm_hog" "erogac_tot"
[116] "cuota_viv"  "mater_serv" "material"   "servicio"   "deposito"  
[121] "prest_terc" "pago_tarje" "deudas"     "balance"    "otras_erog"
[126] "smg"        "ent"        "mun"       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>vars<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"clase_hog"</span>,  <span class="st">"sexo_jefe"</span>,  <span class="st">"edad_jefe"</span> , <span class="st">"educa_jefe"</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>tabs<span class="ot">&lt;-</span> vars <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">count</span>(<span class="at">x=</span>concentrado2020,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>              <span class="sc">!!</span><span class="fu">as.name</span>(.x), <span class="co"># para que ponga la variable a tabular</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">wt=</span>factor) <span class="sc">%&gt;%</span> <span class="co"># para que use el pes</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>((n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="co"># Para que ponga el %</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">adorn_totals</span>()</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>tabs <span class="co"># tabulados expandidos para mandar a un excel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 clase_hog        n    pct
         1  4233047  11.84
         2 22093441  61.80
         3  8999787  25.17
         4   278353   0.78
         5   145031   0.41
     Total 35749659 100.00

[[2]]
 sexo_jefe        n    pct
         1 25072652  70.13
         2 10677007  29.87
     Total 35749659 100.00

[[3]]
 edad_jefe        n    pct
        14      206   0.00
        15      801   0.00
        16     7563   0.02
        17     9373   0.03
        18    32313   0.09
        19    49173   0.14
        20    87861   0.25
        21   119741   0.33
        22   160659   0.45
        23   234934   0.66
        24   245194   0.69
        25   302740   0.85
        26   358181   1.00
        27   393797   1.10
        28   453394   1.27
        29   480245   1.34
        30   595832   1.67
        31   477389   1.34
        32   594044   1.66
        33   538747   1.51
        34   585142   1.64
        35   679411   1.90
        36   640705   1.79
        37   623343   1.74
        38   771090   2.16
        39   676548   1.89
        40   850750   2.38
        41   633938   1.77
        42   910197   2.55
        43   811414   2.27
        44   743078   2.08
        45   858338   2.40
        46   793630   2.22
        47   839846   2.35
        48   895754   2.51
        49   802282   2.24
        50   955486   2.67
        51   633909   1.77
        52   873950   2.44
        53   791650   2.21
        54   763664   2.14
        55   792306   2.22
        56   789150   2.21
        57   689864   1.93
        58   699728   1.96
        59   633661   1.77
        60   815146   2.28
        61   531612   1.49
        62   638709   1.79
        63   657153   1.84
        64   566999   1.59
        65   606264   1.70
        66   459693   1.29
        67   488873   1.37
        68   554800   1.55
        69   427911   1.20
        70   519709   1.45
        71   348224   0.97
        72   438795   1.23
        73   369007   1.03
        74   362156   1.01
        75   371473   1.04
        76   279436   0.78
        77   259322   0.73
        78   296529   0.83
        79   199962   0.56
        80   287766   0.80
        81   138220   0.39
        82   176749   0.49
        83   165610   0.46
        84   177493   0.50
        85   173183   0.48
        86   117048   0.33
        87    93482   0.26
        88    75593   0.21
        89    54120   0.15
        90    63175   0.18
        91    27289   0.08
        92    33386   0.09
        93    24338   0.07
        94    22829   0.06
        95    14664   0.04
        96     9677   0.03
        97     9276   0.03
        98     4954   0.01
        99     3278   0.01
       100     1057   0.00
       101     1296   0.00
       102      863   0.00
       103      607   0.00
       104      621   0.00
       105      146   0.00
       107      145   0.00
     Total 35749659 100.01

[[4]]
 educa_jefe        n    pct
          1  2287415   6.40
          2     4946   0.01
          3  5111202  14.30
          4  5743095  16.06
          5  1175737   3.29
          6  9244410  25.86
          7  1321912   3.70
          8  4598279  12.86
          9  1228591   3.44
         10  4144117  11.59
         11   889955   2.49
      Total 35749659 100.00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tabs)<span class="ot">&lt;-</span>vars <span class="co"># para que las hojas del excel se llamen como la variables</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(tabs, <span class="at">path=</span><span class="st">"tabs.xlsx"</span>)            </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./P5.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fusionado de conjuntos de datos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>