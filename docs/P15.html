<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.163">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R para el monitoreo de la política de desarrollo social - 15&nbsp; Análisis de texto (I)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./P16.html" rel="next">
<link href="./P14.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Análisis de texto (I)</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R para el monitoreo de la política de desarrollo social</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introducción al curso</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./instala.html" class="sidebar-item-text sidebar-link">Instalación de R y Rstudio</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Primer acercamiento al uso del programa</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Manejo de datos: importación, selección y revisión</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Análisis descriptivo básico</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Factores de expansión y algunas otras medidas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fusionado de conjuntos de datos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Funciones, condicionales, bucles y mapeos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualización de datos (I)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P8.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Visualización de datos (II)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P9.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Visualización de datos (III)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P10.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualización de datos (IV)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P11.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">API INEGI e intro a <code>{plotly}</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P12.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualización espacial - Mapas (I)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P13_osm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Visualización espacial - Mapas (II)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P14.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introducción a los tableros con <code>{shiny}</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P15.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Análisis de texto (I)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P16.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Análisis de texto (II)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P17.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Análisis de texto (III)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P18.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Análisis de texto (IV)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P19.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introducción a Rmarkdown</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#paquetes" id="toc-paquetes" class="nav-link active" data-scroll-target="#paquetes"><span class="toc-section-number">15.1</span>  Paquetes</a></li>
  <li><a href="#importar-desde-un-archivo-.txt" id="toc-importar-desde-un-archivo-.txt" class="nav-link" data-scroll-target="#importar-desde-un-archivo-.txt"><span class="toc-section-number">15.2</span>  Importar desde un archivo .txt</a></li>
  <li><a href="#importar-un-epub" id="toc-importar-un-epub" class="nav-link" data-scroll-target="#importar-un-epub"><span class="toc-section-number">15.3</span>  Importar un epub</a></li>
  <li><a href="#importar-un-pdf-conpdftools" id="toc-importar-un-pdf-conpdftools" class="nav-link" data-scroll-target="#importar-un-pdf-conpdftools"><span class="toc-section-number">15.4</span>  Importar un pdf con<code>{pdftools}</code></a></li>
  <li><a href="#extrayendo-tablas-de-un-pdf-conn-tabulizer" id="toc-extrayendo-tablas-de-un-pdf-conn-tabulizer" class="nav-link" data-scroll-target="#extrayendo-tablas-de-un-pdf-conn-tabulizer"><span class="toc-section-number">15.5</span>  Extrayendo tablas de un pdf conn <code>{tabulizer}</code></a></li>
  <li><a href="#importar-una-imagen-con-texto-con-tesseract" id="toc-importar-una-imagen-con-texto-con-tesseract" class="nav-link" data-scroll-target="#importar-una-imagen-con-texto-con-tesseract"><span class="toc-section-number">15.6</span>  Importar una imagen con texto con <code>{tesseract}</code></a></li>
  <li><a href="#stringr-limpieza-de-variables-de-cadena" id="toc-stringr-limpieza-de-variables-de-cadena" class="nav-link" data-scroll-target="#stringr-limpieza-de-variables-de-cadena"><span class="toc-section-number">15.7</span>  <code>{stringr}</code> Limpieza de variables de cadena</a></li>
  <li><a href="#más-operaciones-con-cadenas-con-stringr-y-tokenizers" id="toc-más-operaciones-con-cadenas-con-stringr-y-tokenizers" class="nav-link" data-scroll-target="#más-operaciones-con-cadenas-con-stringr-y-tokenizers"><span class="toc-section-number">15.8</span>  Más operaciones con cadenas con <code>{stringr}</code> y <code>{tokenizers}</code></a></li>
  <li><a href="#tokenización-para-análisis-de-texto" id="toc-tokenización-para-análisis-de-texto" class="nav-link" data-scroll-target="#tokenización-para-análisis-de-texto"><span class="toc-section-number">15.9</span>  Tokenización para análisis de texto</a>
  <ul class="collapse">
  <li><a href="#tokenización-con-tidytext" id="toc-tokenización-con-tidytext" class="nav-link" data-scroll-target="#tokenización-con-tidytext"><span class="toc-section-number">15.9.1</span>  Tokenización con <code>{tidytext}</code></a></li>
  <li><a href="#tokenización-con-udpipe" id="toc-tokenización-con-udpipe" class="nav-link" data-scroll-target="#tokenización-con-udpipe"><span class="toc-section-number">15.9.2</span>  Tokenización con <code>{udpipe}</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Análisis de texto (I)</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>En esta primera práctica veremos algunas acciones para importación de texto para su análisis, así como el manejo de diferentes fuentes, así como importación de tablas desde pdf.</p>
<section id="paquetes" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="paquetes"><span class="header-section-number">15.1</span> Paquetes</h2>
<p><em>NOTA</em> Además de estos paquetes, necesitamos descargar JAVA en nuestro sistema operativo</p>
<p><a href="https://www.java.com/en/download/" class="uri">https://www.java.com/en/download/</a></p>
<p>Instaleremos algunos paquetes, no todos los usaremos en esta práctica pero para irlos instalando:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tokenizers", dependencies=T)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Este paquete no se pudo instalar con pacman::p_load</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para Windows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on 64-bit Windows</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github(c("ropensci/tabulizerjars", "ropensci/tabulizer"), INSTALL_opts = "--no-multiarch")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para MAC</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github(c("ropensci/tabulizerjars", "ropensci/tabulizer"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>) <span class="co"># instala pacman si se requiere</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, tidytext,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>               tm, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>               NLP, SnowballC, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>               wordcloud, ggwordcloud,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>               quanteda, udpipe,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>               igraph, ggraph, <span class="co"># para unos gráficos</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>               readxl, janitor, textrank,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>               broom, epubr, pdftools, tesseract, tokenizers,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>               rJava, tabulizerjars, tabulizer )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importar-desde-un-archivo-.txt" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="importar-desde-un-archivo-.txt"><span class="header-section-number">15.2</span> Importar desde un archivo .txt</h2>
<p>Vamos a importar el discurso que el presidente dio el 1 de julio: <a href="https://lopezobrador.org.mx/2022/07/01/discurso-del-presidente-andres-manuel-lopez-obrador-en-4-ano-del-triunfo-democratico-historico/" class="uri">https://lopezobrador.org.mx/2022/07/01/discurso-del-presidente-andres-manuel-lopez-obrador-en-4-ano-del-triunfo-democratico-historico/</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>amlo <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"datos/text/20220107_amlo.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Revisemos un poco este objeto</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(amlo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Length     Class      Mode 
      113 character character </code></pre>
</div>
</div>
<p>Tenemos 113 párrafos. Al momento no tenemos más información que lo revisaremos en siguientes secciones</p>
</section>
<section id="importar-un-epub" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="importar-un-epub"><span class="header-section-number">15.3</span> Importar un epub</h2>
<p>El proyecto Gutenberg tiene una selección de libros publicados sin problemas de derechos de Autor. Trabajaremos con los <em>Cuentos de Amor de Locura y de Muerte</em> de Horacio Quiroga</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>epubr<span class="sc">::</span><span class="fu">epub_head</span>(<span class="st">"datos/text/quiroga.epub"</span>) <span class="co"># muestra lo primero </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  section           text                                                  
  &lt;chr&gt;             &lt;chr&gt;                                                 
1 pg-header         "The Project Gutenberg eBook of Cuentos de Amor de "  
2 id00249           "#LOS OJOS SOMBRIOS#\n\nDespués de las primeras seman"
3 id00535           "#EL INFIERNO ARTIFICIAL#\n\nLas noches en que hay lu"
4 id00745           "#EL PERRO RABIOSO#\n\nEl 20 de marzo de este año, lo"
5 id01047           "#LOS MENSÚ#\n\nCayetano Maidana y Esteban Podeley, p"
6 id01212           "#LOS PESCADORES DE VIGAS#\n\nEl motivo fué cierto ju"
7 id01445           "#LA MENINGITIS Y SU SOMBRA#\n\nNo vuelvo de mi sorpr"
8 pg-footer         "*** END OF THIS PROJECT GUTENBERG EBOOK ***\n      " 
9 coverpage-wrapper ""                                                    </code></pre>
</div>
</div>
<p>Es una selección de cuentos. Revisemos un poco la meta-data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>epubr<span class="sc">::</span><span class="fu">epub_meta</span>(<span class="st">"datos/text/quiroga.epub"</span>) <span class="co"># muestra el meta-data del libro</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  rights                    identif…¹ creator title langu…² subject date  source
  &lt;chr&gt;                     &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; 
1 Public domain in the USA. http://w… Horaci… Cuen… es      Short … 2004… https…
# … with abbreviated variable names ¹​identifier, ²​language</code></pre>
</div>
</div>
<p>Hoy sí lo vamos a importar en nuestro ambiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> epubr<span class="sc">::</span><span class="fu">epub</span>(<span class="st">"datos/text/quiroga.epub"</span>) <span class="co"># Importa todo el libro en el objeto x, pero no queremos todo</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 9
  rights             ident…¹ creator title langu…² subject date  source data    
  &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;list&gt;  
1 Public domain in … http:/… Horaci… Cuen… es      Short … 2004… https… &lt;tibble&gt;
# … with abbreviated variable names ¹​identifier, ²​language</code></pre>
</div>
</div>
<p>¿Dónde están los cuentos?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 9
$ rights     &lt;chr&gt; "Public domain in the USA."
$ identifier &lt;chr&gt; "http://www.gutenberg.org/13507"
$ creator    &lt;chr&gt; "Horacio Quiroga"
$ title      &lt;chr&gt; "Cuentos de Amor de Locura y de Muerte"
$ language   &lt;chr&gt; "es"
$ subject    &lt;chr&gt; "Short stories, Uruguayan|Uruguayan fiction"
$ date       &lt;chr&gt; "2004-09-20|2022-10-06T21:09:10.400769+00:00"
$ source     &lt;chr&gt; "https://www.gutenberg.org/files/13507/13507-8.txt"
$ data       &lt;list&gt; [&lt;tbl_df[9 x 4]&gt;]</code></pre>
</div>
</div>
<p>Vemos que en realidad la última variable es una lista que adentro trae un objeto “tbl_df” de 9 x 4. Revisemos qué hay</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x<span class="sc">$</span>data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 9 × 4
  section           text                                             nword nchar
  &lt;chr&gt;             &lt;chr&gt;                                            &lt;int&gt; &lt;int&gt;
1 pg-header         "The Project Gutenberg eBook of Cuentos de Amor…  6435 37893
2 id00249           "#LOS OJOS SOMBRIOS#\n\nDespués de las primeras…  5831 34153
3 id00535           "#EL INFIERNO ARTIFICIAL#\n\nLas noches en que …  7190 42642
4 id00745           "#EL PERRO RABIOSO#\n\nEl 20 de marzo de este a…  9356 55680
5 id01047           "#LOS MENSÚ#\n\nCayetano Maidana y Esteban Pode…  6816 40770
6 id01212           "#LOS PESCADORES DE VIGAS#\n\nEl motivo fué cie…  6325 38243
7 id01445           "#LA MENINGITIS Y SU SOMBRA#\n\nNo vuelvo de mi…  7364 43275
8 pg-footer         "*** END OF THIS PROJECT GUTENBERG EBOOK ***\n …  2894 18593
9 coverpage-wrapper ""                                                   0     0</code></pre>
</div>
</div>
<p>Como es una lista, pero una lista de un solo elemento [[1]], vamos a consultarlo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>data[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
  section           text                                             nword nchar
  &lt;chr&gt;             &lt;chr&gt;                                            &lt;int&gt; &lt;int&gt;
1 pg-header         "The Project Gutenberg eBook of Cuentos de Amor…  6435 37893
2 id00249           "#LOS OJOS SOMBRIOS#\n\nDespués de las primeras…  5831 34153
3 id00535           "#EL INFIERNO ARTIFICIAL#\n\nLas noches en que …  7190 42642
4 id00745           "#EL PERRO RABIOSO#\n\nEl 20 de marzo de este a…  9356 55680
5 id01047           "#LOS MENSÚ#\n\nCayetano Maidana y Esteban Pode…  6816 40770
6 id01212           "#LOS PESCADORES DE VIGAS#\n\nEl motivo fué cie…  6325 38243
7 id01445           "#LA MENINGITIS Y SU SOMBRA#\n\nNo vuelvo de mi…  7364 43275
8 pg-footer         "*** END OF THIS PROJECT GUTENBERG EBOOK ***\n …  2894 18593
9 coverpage-wrapper ""                                                   0     0</code></pre>
</div>
</div>
<p>Esta es nuestra matriz de datos. Aquí podemos elegir una sección. Por ejemplo un cuento</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>epub<span class="ot">&lt;-</span>x<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(epub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
</div>
<p>Vamos a quedarnos con un solo cuento:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ojos_sombrios<span class="ot">&lt;-</span>epub <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section<span class="sc">==</span><span class="st">"id00249"</span>) <span class="sc">%&gt;%</span>  <span class="co"># nos quedamos con el primer cuento</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(text)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>ojos_sombrios</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  text                                                                          
  &lt;chr&gt;                                                                         
1 "#LOS OJOS SOMBRIOS#\n\nDespués de las primeras semanas de romper con Elena, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ojos_sombrios)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
</div>
<p>Sigue teniendo formato de data.frame. Para poder usar algunos elementos necesitamos convertirlo a texto. Por eso lo vamos a “pegar”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ojos_sombrios<span class="ot">&lt;-</span><span class="fu">paste</span>(ojos_sombrios<span class="sc">$</span>text) <span class="co"># lo volvemos caracter</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ojos_sombrios)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>Con esto ya podremos hacer muchas operaciones de aquí en adelante.</p>
</section>
<section id="importar-un-pdf-conpdftools" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="importar-un-pdf-conpdftools"><span class="header-section-number">15.4</span> Importar un pdf con<code>{pdftools}</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dof4nov <span class="ot">&lt;-</span> pdftools<span class="sc">::</span><span class="fu">pdf_text</span>(<span class="st">"datos/text/04112022-MAT.pdf"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>dof4nov[<span class="dv">6</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "   6                                            DIARIO OFICIAL                 Viernes 4 de noviembre de 2022\n\n   Con oficio número SEGOB/CNBP/2354/2022, de fecha 12 de agosto de 2022, “LA CNBP” autorizó la\nprocedencia de la solicitud de acceso al recurso concursable, lo anterior, con fundamento en los artículos 21,\n22, 23 y 24 de los “Lineamientos”, y en términos de la Cláusula Vigésima del Convenio de Coordinación\ny Adhesión.\n   Por lo que, resulta necesario utilizar la totalidad de los recursos destinados para el otorgamiento de\nsubsidios a las entidades federativas para realizar acciones de búsqueda en materia de desaparición forzada\nde personas y desaparición cometida por particulares.\n                                              DECLARACIONES\n   I.     “LA CNBP” declara que:\n   I.1.   En virtud de que el presente Convenio Modificatorio se deriva del Convenio de Coordinación y\n          Adhesión, las Declaraciones manifestadas en dicho instrumento permanecen vigentes, con\n          excepción de las expresadas en el presente Convenio Modificatorio, por lo que se tienen por\n          reproducidas y ratificadas en su integridad como si a la letra se insertaran en el Convenio de\n          Coordinación y Adhesión de referencia.\n   I.2.   Las documentales, justificativas y comprobatorias que acreditan y sustentan la procedencia de este\n          instrumento, obran en el expediente de “LA CNBP”; lo anterior, para todos los fines y efectos\n          legales a que haya lugar, por lo que corresponde a dicha área cualquier justificación y sustento sobre\n          el particular.\n   II.    La “ENTIDAD FEDERATIVA” declara que:\n   II.1. Es su intención celebrar el presente Convenio Modificatorio al Convenio de Coordinación y Adhesión,\n         en términos del presente instrumento jurídico.\n   II.2. En virtud de que el presente Convenio Modificatorio se deriva del Convenio de Coordinación y\n         Adhesión, las declaraciones manifestadas en dicho instrumento permanecen vigentes con excepción\n         de las expresadas en el presente Convenio Modificatorio por lo que se tienen por reproducidas\n         y ratificadas en su integridad como si a la letra se insertaran en el Convenio de Coordinación y\n         Adhesión de referencia, actualizándose las identificadas con los numerales II.4 y II.5, toda vez que\n         hubo sustitución de funcionarios, para quedar como sigue.\n             II.4. Samuel Sotelo Salgado, Secretario de Gobierno del Poder Ejecutivo Estatal, acredita\n                   su personalidad con el nombramiento otorgado a su favor por el Gobernador\n                   Constitucional del Estado con fecha 03 de mayo de 2022, y tiene facultades para\n                   suscribir el presente Convenio, de conformidad con los artículos 74 de la Constitución\n                   Política del Estado Libre y Soberano de Morelos; 3, párrafo tercero, 4, fracción I, 9,\n                   fracción II, 13, fracción VI, 14 y 22, fracción VII, de la Ley Orgánica de la\n                   Administración Pública del Estado Libre y Soberano de Morelos, y 8 y 9, fracción VII,\n                   del Reglamento Interior de la Secretaría de Gobierno.\n             II.5. José Gerardo López Huérfano, Encargado de Despacho de la Secretaría de Hacienda\n                   del Estado, acredita su personalidad con el nombramiento otorgado a su favor por el\n                   Gobernador del Estado con fecha 03 de mayo de 2022, y tiene facultades para\n                   suscribir el presente Convenio, de conformidad con los artículos 74 de la Constitución\n                   Política del Estado Libre y Soberano de Morelos; 3, 4, fracción I, 9, fracción III, 13,\n                   fracción VI, 14, 15 y 23, fracción IV, de la Ley Orgánica de la Administración Pública\n                   del Estado Libre y Soberano de Morelos, y 11, 12, fracción XII y 41 del Reglamento\n                   Interior de la Secretaría de Hacienda.\n   III.   “LAS PARTES” declaran que:\n   III.1. Cuentan con las facultades necesarias para intervenir en la suscripción del presente Convenio\n          Modificatorio.\n   III.2. Se reconocen mutuamente la personalidad con que se ostentan y manifiestan su conformidad para la\n          celebración del presente Convenio Modificatorio.\n   III.3. Celebran el presente instrumento, de conformidad con lo establecido en los artículos 21, 22, 23,\n          24 y 25 de los “Lineamientos” y en términos de la Cláusula Vigésima del Convenio de Coordinación\n          y Adhesión.\n"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(dof4nov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>Para verlo mejor podemos usar el comando <code>cat()</code> de base para cada una de las “hojas”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(dof4nov[<span class="dv">6</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   6                                            DIARIO OFICIAL                 Viernes 4 de noviembre de 2022

   Con oficio número SEGOB/CNBP/2354/2022, de fecha 12 de agosto de 2022, “LA CNBP” autorizó la
procedencia de la solicitud de acceso al recurso concursable, lo anterior, con fundamento en los artículos 21,
22, 23 y 24 de los “Lineamientos”, y en términos de la Cláusula Vigésima del Convenio de Coordinación
y Adhesión.
   Por lo que, resulta necesario utilizar la totalidad de los recursos destinados para el otorgamiento de
subsidios a las entidades federativas para realizar acciones de búsqueda en materia de desaparición forzada
de personas y desaparición cometida por particulares.
                                              DECLARACIONES
   I.     “LA CNBP” declara que:
   I.1.   En virtud de que el presente Convenio Modificatorio se deriva del Convenio de Coordinación y
          Adhesión, las Declaraciones manifestadas en dicho instrumento permanecen vigentes, con
          excepción de las expresadas en el presente Convenio Modificatorio, por lo que se tienen por
          reproducidas y ratificadas en su integridad como si a la letra se insertaran en el Convenio de
          Coordinación y Adhesión de referencia.
   I.2.   Las documentales, justificativas y comprobatorias que acreditan y sustentan la procedencia de este
          instrumento, obran en el expediente de “LA CNBP”; lo anterior, para todos los fines y efectos
          legales a que haya lugar, por lo que corresponde a dicha área cualquier justificación y sustento sobre
          el particular.
   II.    La “ENTIDAD FEDERATIVA” declara que:
   II.1. Es su intención celebrar el presente Convenio Modificatorio al Convenio de Coordinación y Adhesión,
         en términos del presente instrumento jurídico.
   II.2. En virtud de que el presente Convenio Modificatorio se deriva del Convenio de Coordinación y
         Adhesión, las declaraciones manifestadas en dicho instrumento permanecen vigentes con excepción
         de las expresadas en el presente Convenio Modificatorio por lo que se tienen por reproducidas
         y ratificadas en su integridad como si a la letra se insertaran en el Convenio de Coordinación y
         Adhesión de referencia, actualizándose las identificadas con los numerales II.4 y II.5, toda vez que
         hubo sustitución de funcionarios, para quedar como sigue.
             II.4. Samuel Sotelo Salgado, Secretario de Gobierno del Poder Ejecutivo Estatal, acredita
                   su personalidad con el nombramiento otorgado a su favor por el Gobernador
                   Constitucional del Estado con fecha 03 de mayo de 2022, y tiene facultades para
                   suscribir el presente Convenio, de conformidad con los artículos 74 de la Constitución
                   Política del Estado Libre y Soberano de Morelos; 3, párrafo tercero, 4, fracción I, 9,
                   fracción II, 13, fracción VI, 14 y 22, fracción VII, de la Ley Orgánica de la
                   Administración Pública del Estado Libre y Soberano de Morelos, y 8 y 9, fracción VII,
                   del Reglamento Interior de la Secretaría de Gobierno.
             II.5. José Gerardo López Huérfano, Encargado de Despacho de la Secretaría de Hacienda
                   del Estado, acredita su personalidad con el nombramiento otorgado a su favor por el
                   Gobernador del Estado con fecha 03 de mayo de 2022, y tiene facultades para
                   suscribir el presente Convenio, de conformidad con los artículos 74 de la Constitución
                   Política del Estado Libre y Soberano de Morelos; 3, 4, fracción I, 9, fracción III, 13,
                   fracción VI, 14, 15 y 23, fracción IV, de la Ley Orgánica de la Administración Pública
                   del Estado Libre y Soberano de Morelos, y 11, 12, fracción XII y 41 del Reglamento
                   Interior de la Secretaría de Hacienda.
   III.   “LAS PARTES” declaran que:
   III.1. Cuentan con las facultades necesarias para intervenir en la suscripción del presente Convenio
          Modificatorio.
   III.2. Se reconocen mutuamente la personalidad con que se ostentan y manifiestan su conformidad para la
          celebración del presente Convenio Modificatorio.
   III.3. Celebran el presente instrumento, de conformidad con lo establecido en los artículos 21, 22, 23,
          24 y 25 de los “Lineamientos” y en términos de la Cláusula Vigésima del Convenio de Coordinación
          y Adhesión.</code></pre>
</div>
</div>
<p>Qué pasa cuando nuestro pdf tiene datos como tablas, ¿no sería genial?</p>
</section>
<section id="extrayendo-tablas-de-un-pdf-conn-tabulizer" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="extrayendo-tablas-de-un-pdf-conn-tabulizer"><span class="header-section-number">15.5</span> Extrayendo tablas de un pdf conn <code>{tabulizer}</code></h2>
<p>Tenemos un pequeño extracto del PEF</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>PEF <span class="ot">&lt;-</span> pdftools<span class="sc">::</span><span class="fu">pdf_data</span>(<span class="st">"datos/text/tomo_1_fa.pdf"</span>)[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Este funciona cuando tenemos “tablas limpias”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tab1 <span class="ot">&lt;-</span> tabulizer<span class="sc">::</span><span class="fu">extract_tables</span>(<span class="st">"datos/text/tomo_1_fa.pdf"</span>, <span class="at">pages =</span> <span class="dv">3</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> tabulizer<span class="sc">::</span><span class="fu">extract_tables</span>(<span class="st">"datos/text/tomo_1_fa.pdf"</span>, <span class="at">pages =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>tabla1<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(tab1[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if
`.name_repair` is omitted as of tibble 2.0.0.
ℹ Using compatibility `.name_repair`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>tabla2<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(tab2[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vamos a juntar estas tablas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>pef2022<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(<span class="fu">rbind</span>(tabla1[<span class="sc">-</span><span class="dv">1</span>,], </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                         tabla2[<span class="sc">-</span><span class="dv">1</span>,])) <span class="co">#no queremos las primeras filas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vamos a limpiar estos datos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pef2022)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"objeto"</span>, <span class="st">"importe"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hoy veamos que nuestro importe está</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(pef2022<span class="sc">$</span>importe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>Un problema es para convertirlo al número como tiene comas si hacemos un “as.numeric” lo hará NA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>pef2022 <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">importe2=</span><span class="fu">as.numeric</span>(importe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in mask$eval_all_mutate(quo): NAs introducidos por coerción</code></pre>
</div>
</div>
<p>¿Qué hacer?</p>
<p>Primero vamos a eliminar todas las comas de nuestra columna.. introduciremos un poco el paquete <code>{stringr}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pef2022 <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">importe2=</span>stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(importe,<span class="at">pattern=</span><span class="st">","</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">importe2=</span><span class="fu">as.numeric</span>(importe2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Supongamos que queremos graficar los objetos que tengan que ver con “servicios”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>pef2022 <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(objeto, <span class="co"># variable de caracter</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">pattern=</span><span class="st">"Servicios"</span>)) <span class="sc">%&gt;%</span> <span class="co"># patrón que buscamos que tenga</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>objeto, <span class="at">y=</span><span class="fu">round</span>(importe2<span class="sc">/</span><span class="dv">1000000</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="P15_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="importar-una-imagen-con-texto-con-tesseract" class="level2" data-number="15.6">
<h2 data-number="15.6" class="anchored" data-anchor-id="importar-una-imagen-con-texto-con-tesseract"><span class="header-section-number">15.6</span> Importar una imagen con texto con <code>{tesseract}</code></h2>
<p>El paquete <code>{tesseract}</code> …</p>
<blockquote class="blockquote">
<p>“utiliza datos de entrenamiento para realizar OCR. La mayoría de los sistemas utilizan de forma predeterminada los datos de entrenamiento en inglés”. Para mejorar el rendimiento de OCR para otros idiomas, puede instalar los datos de entrenamiento de su distribución… En Windows y MacOS, puede instalar idiomas mediante la función tesseract_download, que descarga datos de entrenamiento directamente desde github y los almacena en la ruta del disco…” (traducido de la viñeta)</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.na</span>(<span class="fu">match</span>(<span class="st">"spa"</span>, tesseract<span class="sc">::</span><span class="fu">tesseract_info</span>()<span class="sc">$</span>available)))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  tesseract<span class="sc">::</span><span class="fu">tesseract_download</span>(<span class="st">"spa"</span>) <span class="co"># baja el entrenamiento para español</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>spa <span class="ot">&lt;-</span> tesseract<span class="sc">::</span><span class="fu">tesseract</span>(<span class="st">"spa"</span>) <span class="co"># aquí este será el "engine"</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span> tesseract<span class="sc">::</span><span class="fu">ocr</span>(<span class="st">"datos/text/texto1.png"</span>, <span class="co">#ruta donde está la imagen</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">engine =</span> spa) <span class="co"># que lo lea en español</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NOTA

Las denominaciones empleadas en esta publicación y la forma en que aparecen
presentados los datos que contiene no implican, de parte de la Secretaría de las
Naciones Unidas, juicio alguno sobre la condición jurídica de ninguno de los países o
territorios citados o de sus autoridades, ni respecto de la delimitación de sus fronte-
ras O límites.

En algunos cuadros, las designaciones economías “desarrolladas” y “en
desarrollo”? se emplean por razones estadísticas y no expresan necesariamente juicio
alguno sobre la etapa alcanzada por un determinado país o zona en el proceso de
desarrollo,

El término “país” usado en el texto de esta publicación también se refiere, cuan-
do proceda, a territorios o áreas.

Los puntos de vista que se exponen en esta publicación son los de sus respectivos
autores y no entrañan la manifestación de opinión alguna por parte de la Secretaría
de las Naciones Unidas.

Esta publicación ha sido preparada y refundida con arreglo a la práctica y
requerimientos de las Naciones Unidas.

Las signaturas de los documentos de las Naciones Unidas se componen de letras
mayúsculas y cifras. La mención de una de tales signaturas indica que se hace
referencia a un documento de las Naciones Unidas.</code></pre>
</div>
</div>
</section>
<section id="stringr-limpieza-de-variables-de-cadena" class="level2" data-number="15.7">
<h2 data-number="15.7" class="anchored" data-anchor-id="stringr-limpieza-de-variables-de-cadena"><span class="header-section-number">15.7</span> <code>{stringr}</code> Limpieza de variables de cadena</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_squish</span>(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "NOTA Las denominaciones empleadas en esta publicación y la forma en que aparecen presentados los datos que contiene no implican, de parte de la Secretaría de las Naciones Unidas, juicio alguno sobre la condición jurídica de ninguno de los países o territorios citados o de sus autoridades, ni respecto de la delimitación de sus fronte- ras O límites. En algunos cuadros, las designaciones economías “desarrolladas” y “en desarrollo”? se emplean por razones estadísticas y no expresan necesariamente juicio alguno sobre la etapa alcanzada por un determinado país o zona en el proceso de desarrollo, El término “país” usado en el texto de esta publicación también se refiere, cuan- do proceda, a territorios o áreas. Los puntos de vista que se exponen en esta publicación son los de sus respectivos autores y no entrañan la manifestación de opinión alguna por parte de la Secretaría de las Naciones Unidas. Esta publicación ha sido preparada y refundida con arreglo a la práctica y requerimientos de las Naciones Unidas. Las signaturas de los documentos de las Naciones Unidas se componen de letras mayúsculas y cifras. La mención de una de tales signaturas indica que se hace referencia a un documento de las Naciones Unidas."</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>nota<span class="ot">&lt;-</span>stringr<span class="sc">::</span><span class="fu">str_split_fixed</span>(text, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>, <span class="at">n=</span><span class="dv">10</span>) <span class="do">## por párrafos</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>nota</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  
[1,] "NOTA"
     [,2]                                                                                                                                                                                                                                                                                                                                                           
[1,] "Las denominaciones empleadas en esta publicación y la forma en que aparecen\npresentados los datos que contiene no implican, de parte de la Secretaría de las\nNaciones Unidas, juicio alguno sobre la condición jurídica de ninguno de los países o\nterritorios citados o de sus autoridades, ni respecto de la delimitación de sus fronte-\nras O límites."
     [,3]                                                                                                                                                                                                                                                       
[1,] "En algunos cuadros, las designaciones economías “desarrolladas” y “en\ndesarrollo”? se emplean por razones estadísticas y no expresan necesariamente juicio\nalguno sobre la etapa alcanzada por un determinado país o zona en el proceso de\ndesarrollo,"
     [,4]                                                                                                                   
[1,] "El término “país” usado en el texto de esta publicación también se refiere, cuan-\ndo proceda, a territorios o áreas."
     [,5]                                                                                                                                                                                             
[1,] "Los puntos de vista que se exponen en esta publicación son los de sus respectivos\nautores y no entrañan la manifestación de opinión alguna por parte de la Secretaría\nde las Naciones Unidas."
     [,6]                                                                                                                
[1,] "Esta publicación ha sido preparada y refundida con arreglo a la práctica y\nrequerimientos de las Naciones Unidas."
     [,7]                                                                                                                                                                                                               
[1,] "Las signaturas de los documentos de las Naciones Unidas se componen de letras\nmayúsculas y cifras. La mención de una de tales signaturas indica que se hace\nreferencia a un documento de las Naciones Unidas.\n"
     [,8] [,9] [,10]
[1,] ""   ""   ""   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_count</span>(text, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>nota<span class="ot">&lt;-</span>stringr<span class="sc">::</span><span class="fu">str_split_fixed</span>(text,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">pattern=</span><span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n=</span><span class="fu">str_count</span>(text, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)<span class="sc">+</span><span class="dv">1</span>) <span class="do">## por párrafos</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>nota</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  
[1,] "NOTA"
     [,2]                                                                                                                                                                                                                                                                                                                                                           
[1,] "Las denominaciones empleadas en esta publicación y la forma en que aparecen\npresentados los datos que contiene no implican, de parte de la Secretaría de las\nNaciones Unidas, juicio alguno sobre la condición jurídica de ninguno de los países o\nterritorios citados o de sus autoridades, ni respecto de la delimitación de sus fronte-\nras O límites."
     [,3]                                                                                                                                                                                                                                                       
[1,] "En algunos cuadros, las designaciones economías “desarrolladas” y “en\ndesarrollo”? se emplean por razones estadísticas y no expresan necesariamente juicio\nalguno sobre la etapa alcanzada por un determinado país o zona en el proceso de\ndesarrollo,"
     [,4]                                                                                                                   
[1,] "El término “país” usado en el texto de esta publicación también se refiere, cuan-\ndo proceda, a territorios o áreas."
     [,5]                                                                                                                                                                                             
[1,] "Los puntos de vista que se exponen en esta publicación son los de sus respectivos\nautores y no entrañan la manifestación de opinión alguna por parte de la Secretaría\nde las Naciones Unidas."
     [,6]                                                                                                                
[1,] "Esta publicación ha sido preparada y refundida con arreglo a la práctica y\nrequerimientos de las Naciones Unidas."
     [,7]                                                                                                                                                                                                               
[1,] "Las signaturas de los documentos de las Naciones Unidas se componen de letras\nmayúsculas y cifras. La mención de una de tales signaturas indica que se hace\nreferencia a un documento de las Naciones Unidas.\n"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_squish</span>(nota)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "NOTA"                                                                                                                                                                                                                                                                                                                                                     
[2] "Las denominaciones empleadas en esta publicación y la forma en que aparecen presentados los datos que contiene no implican, de parte de la Secretaría de las Naciones Unidas, juicio alguno sobre la condición jurídica de ninguno de los países o territorios citados o de sus autoridades, ni respecto de la delimitación de sus fronte- ras O límites."
[3] "En algunos cuadros, las designaciones economías “desarrolladas” y “en desarrollo”? se emplean por razones estadísticas y no expresan necesariamente juicio alguno sobre la etapa alcanzada por un determinado país o zona en el proceso de desarrollo,"                                                                                                   
[4] "El término “país” usado en el texto de esta publicación también se refiere, cuan- do proceda, a territorios o áreas."                                                                                                                                                                                                                                     
[5] "Los puntos de vista que se exponen en esta publicación son los de sus respectivos autores y no entrañan la manifestación de opinión alguna por parte de la Secretaría de las Naciones Unidas."                                                                                                                                                            
[6] "Esta publicación ha sido preparada y refundida con arreglo a la práctica y requerimientos de las Naciones Unidas."                                                                                                                                                                                                                                        
[7] "Las signaturas de los documentos de las Naciones Unidas se componen de letras mayúsculas y cifras. La mención de una de tales signaturas indica que se hace referencia a un documento de las Naciones Unidas."                                                                                                                                            </code></pre>
</div>
</div>
<p>Si queremos quitar lo “-”, lo podemos hacer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>nota<span class="ot">&lt;-</span>stringr<span class="sc">::</span><span class="fu">str_squish</span>(nota)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(nota, </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pattern=</span><span class="st">"- "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "NOTA"                                                                                                                                                                                                                                                                                                                                                   
[2] "Las denominaciones empleadas en esta publicación y la forma en que aparecen presentados los datos que contiene no implican, de parte de la Secretaría de las Naciones Unidas, juicio alguno sobre la condición jurídica de ninguno de los países o territorios citados o de sus autoridades, ni respecto de la delimitación de sus fronteras O límites."
[3] "En algunos cuadros, las designaciones economías “desarrolladas” y “en desarrollo”? se emplean por razones estadísticas y no expresan necesariamente juicio alguno sobre la etapa alcanzada por un determinado país o zona en el proceso de desarrollo,"                                                                                                 
[4] "El término “país” usado en el texto de esta publicación también se refiere, cuando proceda, a territorios o áreas."                                                                                                                                                                                                                                     
[5] "Los puntos de vista que se exponen en esta publicación son los de sus respectivos autores y no entrañan la manifestación de opinión alguna por parte de la Secretaría de las Naciones Unidas."                                                                                                                                                          
[6] "Esta publicación ha sido preparada y refundida con arreglo a la práctica y requerimientos de las Naciones Unidas."                                                                                                                                                                                                                                      
[7] "Las signaturas de los documentos de las Naciones Unidas se componen de letras mayúsculas y cifras. La mención de una de tales signaturas indica que se hace referencia a un documento de las Naciones Unidas."                                                                                                                                          </code></pre>
</div>
</div>
</section>
<section id="más-operaciones-con-cadenas-con-stringr-y-tokenizers" class="level2" data-number="15.8">
<h2 data-number="15.8" class="anchored" data-anchor-id="más-operaciones-con-cadenas-con-stringr-y-tokenizers"><span class="header-section-number">15.8</span> Más operaciones con cadenas con <code>{stringr}</code> y <code>{tokenizers}</code></h2>
<p>Ya vimos el conteo de algunos patrones y cómo podemos quitar algunos. Trabajemos con el cuento de Quiroga, que también está un poco sucio, y veamos como podemos seguir utilizando el formato tidy</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>ojos_sombrios<span class="ot">&lt;-</span>ojos_sombrios <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_split_fixed</span>( <span class="at">pattern=</span><span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>, <span class="at">n=</span><span class="fu">str_count</span>(text, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)<span class="sc">+</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="do">## por párrafos %</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hay un personaje que se llama Nébel, veámos cuantas veces aparece:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ojos_sombrios)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Length     Class      Mode 
        7 character character </code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>ojos_sombrios <span class="sc">%&gt;%</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_count</span>(<span class="at">pattern=</span><span class="st">"Vezzera"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21</code></pre>
</div>
</div>
<p>Vamos a ver cuántas palabras tiene cada párrafos, hay unos párrafos vacíos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>tokenizers<span class="sc">::</span><span class="fu">count_words</span>(ojos_sombrios)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    3   62   69  135   46   12 5635</code></pre>
</div>
</div>
<p>Revisemos el discurso de Amlo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>tokenizers<span class="sc">::</span><span class="fu">count_words</span>(amlo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]   3   0   2   0   4   0   5   0   2   0   3   0   0  24   0 124   0   0
 [19] 514   0   0   0   0   0  57   0 113   0  33   0 150   0  27   0   0   0
 [37]   0   0   0   0  94   0 171   0  28   0 139   0   0   0   0   0   0   0
 [55] 293   0  25   0  81   0 133   0   0   0   0   0   0   0 180   0 123   0
 [73] 141   0 145   0   0   0   0   0   0   0  99   0  56   0 116   0 114   0
 [91]  87   0   0   0 214   0 208   0  58   0  89   0  85   0   0   0   3   0
[109]  40   0 174   0  99</code></pre>
</div>
</div>
<p>De los 113 párrafos tenemos varios que están en 0. Vamos a eliminarlos. Vemos que txt reconoció los párrafos sin problemas, sin necesidad de poner la marca de párrafo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>count<span class="ot">&lt;-</span>tokenizers<span class="sc">::</span><span class="fu">count_words</span>(amlo) </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>count<span class="sc">==</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE
 [13]  TRUE FALSE  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
 [25] FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE
 [37]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE
 [49]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE
 [61] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE
 [73] FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE
 [85] FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE
 [97] FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE
[109] FALSE  TRUE FALSE  TRUE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>amlo<span class="ot">&lt;-</span>amlo[<span class="sc">!</span>count<span class="sc">==</span><span class="dv">0</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vamos a jugar más con algunas opciones de <code>{tokenizers}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>tokenizers<span class="sc">::</span><span class="fu">count_words</span>(amlo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]   3   2   4   5   2   3  24 124 514  57 113  33 150  27  94 171  28 139 293
[20]  25  81 133 180 123 141 145  99  56 116 114  87 214 208  58  89  85   3  40
[39] 174  99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>tokenizers<span class="sc">::</span><span class="fu">count_sentences</span>(amlo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  1  1  1  1  1  1  4 12  3  4  2  2  1  1  6  1  2  8  1  1  3  4  5  1
[26]  4  1  1  3  1  1  2  3  1  5  1  1  2  6  2</code></pre>
</div>
</div>
</section>
<section id="tokenización-para-análisis-de-texto" class="level2" data-number="15.9">
<h2 data-number="15.9" class="anchored" data-anchor-id="tokenización-para-análisis-de-texto"><span class="header-section-number">15.9</span> Tokenización para análisis de texto</h2>
<p>Las palabras tienen un papel en el lenguaje, por lo cual muchas veces la unidad que usaremos será esa. Uno de los primeros pasos para el análisis de texto será descomponer nuestros textos en palabras.</p>
<section id="tokenización-con-tidytext" class="level3" data-number="15.9.1">
<h3 data-number="15.9.1" class="anchored" data-anchor-id="tokenización-con-tidytext"><span class="header-section-number">15.9.1</span> Tokenización con <code>{tidytext}</code></h3>
<p>Para usar <code>{tidytext}</code>, necesitamos que nuestro texto esté en formato tibble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>amlo_df <span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">text=</span>amlo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A partir de esto podemos pasar al proceso de tokenización:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>amlo_df <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,056 × 1
   word        
   &lt;chr&gt;       
 1 amigas      
 2 y           
 3 amigos      
 4 invitados   
 5 especiales  
 6 presidentes 
 7 municipales 
 8 presidentas 
 9 municipales 
10 gobernadores
# … with 4,046 more rows</code></pre>
</div>
</div>
<p>Podemos hacer un tabulado de estos elementos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>amlo_df <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">unnest_tokens</span>(word, text) <span class="sc">%&gt;%</span> </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(word) <span class="sc">%&gt;%</span> </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> word   n    percent
   de 260 0.06410256
   la 179 0.04413215
    y 145 0.03574951
   en 134 0.03303748
   el 124 0.03057199
  que 120 0.02958580
    a  84 0.02071006
   se  83 0.02046351
  los  59 0.01454635
   es  53 0.01306706</code></pre>
</div>
</div>
<p>Importa el tipo de palabra!!! En muchos idiomas las preposiciones y determinantes son bastante comunes. Hay varios diccionarios, incluso los podemos modificar. Para este ejercicio utilizaremos las palabras comunes del paquete <code>{quanteda}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>quanteda<span class="sc">::</span><span class="fu">stopwords</span>(<span class="at">language=</span><span class="st">"spa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "de"           "la"           "que"          "el"           "en"          
  [6] "y"            "a"            "los"          "del"          "se"          
 [11] "las"          "por"          "un"           "para"         "con"         
 [16] "no"           "una"          "su"           "al"           "lo"          
 [21] "como"         "más"          "pero"         "sus"          "le"          
 [26] "ya"           "o"            "este"         "sí"           "porque"      
 [31] "esta"         "entre"        "cuando"       "muy"          "sin"         
 [36] "sobre"        "también"      "me"           "hasta"        "hay"         
 [41] "donde"        "quien"        "desde"        "todo"         "nos"         
 [46] "durante"      "todos"        "uno"          "les"          "ni"          
 [51] "contra"       "otros"        "ese"          "eso"          "ante"        
 [56] "ellos"        "e"            "esto"         "mí"           "antes"       
 [61] "algunos"      "qué"          "unos"         "yo"           "otro"        
 [66] "otras"        "otra"         "él"           "tanto"        "esa"         
 [71] "estos"        "mucho"        "quienes"      "nada"         "muchos"      
 [76] "cual"         "poco"         "ella"         "estar"        "estas"       
 [81] "algunas"      "algo"         "nosotros"     "mi"           "mis"         
 [86] "tú"           "te"           "ti"           "tu"           "tus"         
 [91] "ellas"        "nosotras"     "vosotros"     "vosotras"     "os"          
 [96] "mío"          "mía"          "míos"         "mías"         "tuyo"        
[101] "tuya"         "tuyos"        "tuyas"        "suyo"         "suya"        
[106] "suyos"        "suyas"        "nuestro"      "nuestra"      "nuestros"    
[111] "nuestras"     "vuestro"      "vuestra"      "vuestros"     "vuestras"    
[116] "esos"         "esas"         "estoy"        "estás"        "está"        
[121] "estamos"      "estáis"       "están"        "esté"         "estés"       
[126] "estemos"      "estéis"       "estén"        "estaré"       "estarás"     
[131] "estará"       "estaremos"    "estaréis"     "estarán"      "estaría"     
[136] "estarías"     "estaríamos"   "estaríais"    "estarían"     "estaba"      
[141] "estabas"      "estábamos"    "estabais"     "estaban"      "estuve"      
[146] "estuviste"    "estuvo"       "estuvimos"    "estuvisteis"  "estuvieron"  
[151] "estuviera"    "estuvieras"   "estuviéramos" "estuvierais"  "estuvieran"  
[156] "estuviese"    "estuvieses"   "estuviésemos" "estuvieseis"  "estuviesen"  
[161] "estando"      "estado"       "estada"       "estados"      "estadas"     
[166] "estad"        "he"           "has"          "ha"           "hemos"       
[171] "habéis"       "han"          "haya"         "hayas"        "hayamos"     
[176] "hayáis"       "hayan"        "habré"        "habrás"       "habrá"       
[181] "habremos"     "habréis"      "habrán"       "habría"       "habrías"     
[186] "habríamos"    "habríais"     "habrían"      "había"        "habías"      
[191] "habíamos"     "habíais"      "habían"       "hube"         "hubiste"     
[196] "hubo"         "hubimos"      "hubisteis"    "hubieron"     "hubiera"     
[201] "hubieras"     "hubiéramos"   "hubierais"    "hubieran"     "hubiese"     
[206] "hubieses"     "hubiésemos"   "hubieseis"    "hubiesen"     "habiendo"    
[211] "habido"       "habida"       "habidos"      "habidas"      "soy"         
[216] "eres"         "es"           "somos"        "sois"         "son"         
[221] "sea"          "seas"         "seamos"       "seáis"        "sean"        
[226] "seré"         "serás"        "será"         "seremos"      "seréis"      
[231] "serán"        "sería"        "serías"       "seríamos"     "seríais"     
[236] "serían"       "era"          "eras"         "éramos"       "erais"       
[241] "eran"         "fui"          "fuiste"       "fue"          "fuimos"      
[246] "fuisteis"     "fueron"       "fuera"        "fueras"       "fuéramos"    
[251] "fuerais"      "fueran"       "fuese"        "fueses"       "fuésemos"    
[256] "fueseis"      "fuesen"       "siendo"       "sido"         "tengo"       
[261] "tienes"       "tiene"        "tenemos"      "tenéis"       "tienen"      
[266] "tenga"        "tengas"       "tengamos"     "tengáis"      "tengan"      
[271] "tendré"       "tendrás"      "tendrá"       "tendremos"    "tendréis"    
[276] "tendrán"      "tendría"      "tendrías"     "tendríamos"   "tendríais"   
[281] "tendrían"     "tenía"        "tenías"       "teníamos"     "teníais"     
[286] "tenían"       "tuve"         "tuviste"      "tuvo"         "tuvimos"     
[291] "tuvisteis"    "tuvieron"     "tuviera"      "tuvieras"     "tuviéramos"  
[296] "tuvierais"    "tuvieran"     "tuviese"      "tuvieses"     "tuviésemos"  
[301] "tuvieseis"    "tuviesen"     "teniendo"     "tenido"       "tenida"      
[306] "tenidos"      "tenidas"      "tened"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>stop<span class="ot">&lt;-</span>quanteda<span class="sc">::</span><span class="fu">stopwords</span>(<span class="at">language=</span><span class="st">"spa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>amlo_df <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">unnest_tokens</span>(word, text) <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word<span class="sc">%in%</span>stop) <span class="sc">%&gt;%</span>  <span class="co"># ojo con el filtro</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(word) <span class="sc">%&gt;%</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         word  n     percent
          mil 29 0.014521783
     millones 16 0.008012018
       ciento 15 0.007511267
    inversión 13 0.006509765
         aquí 12 0.006009014
       méxico 12 0.006009014
         país 12 0.006009014
 trabajadores 12 0.006009014
     gobierno 11 0.005508262
 construcción 10 0.005007511</code></pre>
</div>
</div>
</section>
<section id="tokenización-con-udpipe" class="level3" data-number="15.9.2">
<h3 data-number="15.9.2" class="anchored" data-anchor-id="tokenización-con-udpipe"><span class="header-section-number">15.9.2</span> Tokenización con <code>{udpipe}</code></h3>
<p>Para mayor información consultar <a href="https://ufal.mff.cuni.cz/~straka/papers/2017-conll_udpipe.pdf" class="uri">https://ufal.mff.cuni.cz/~straka/papers/2017-conll_udpipe.pdf</a></p>
<p>Primero vamos a bajar nuestro modelo en español</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>udmodel <span class="ot">&lt;-</span> <span class="fu">udpipe_download_model</span>(<span class="at">language =</span> <span class="st">"spanish"</span>)  <span class="co"># esto trabaja con la estructura del español</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Downloading udpipe model from https://raw.githubusercontent.com/jwijffels/udpipe.models.ud.2.5/master/inst/udpipe-ud-2.5-191206/spanish-gsd-ud-2.5-191206.udpipe to /Users/anaescoto/Dropbox/2022/Curso_r_cnvl/coneval/spanish-gsd-ud-2.5-191206.udpipe</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> - This model has been trained on version 2.5 of data from https://universaldependencies.org</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> - The model is distributed under the CC-BY-SA-NC license: https://creativecommons.org/licenses/by-nc-sa/4.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> - Visit https://github.com/jwijffels/udpipe.models.ud.2.5 for model license details.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> - For a list of all models and their licenses (most models you can download with this package have either a CC-BY-SA or a CC-BY-SA-NC license) read the documentation at ?udpipe_download_model. For building your own models: visit the documentation by typing vignette('udpipe-train', package = 'udpipe')</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Downloading finished, model stored at '/Users/anaescoto/Dropbox/2022/Curso_r_cnvl/coneval/spanish-gsd-ud-2.5-191206.udpipe'</code></pre>
</div>
</div>
<p>Vamos a “tokenizar” el discurso de AMLO:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>amlo_udpipe<span class="ot">&lt;-</span><span class="fu">udpipe</span>(<span class="at">x =</span>amlo, </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">object=</span>udmodel) <span class="co">#"tokeniza" el texto</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Además de separarnos las palabras, también distingue puntuación (por eso tiene más líneas que las palabras), pero también nos da las “Universal POS tags”, donde POS=part-of-speech, que están en la variable “upos”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>amlo_udpipe <span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   doc_id paragraph_id sentence_id
1    doc1            1           1
2    doc1            1           1
3    doc1            1           1
4    doc1            1           1
5    doc2            1           1
6    doc2            1           1
7    doc2            1           1
8    doc3            1           1
9    doc3            1           1
10   doc3            1           1
                                            sentence start end term_id token_id
1                                   Amigas y amigos,     1   6       1        1
2                                   Amigas y amigos,     8   8       2        2
3                                   Amigas y amigos,    10  15       3        3
4                                   Amigas y amigos,    16  16       4        4
5                              Invitados especiales,     1   9       1        1
6                              Invitados especiales,    11  20       2        2
7                              Invitados especiales,    21  21       3        3
8  Presidentes municipales, presidentas municipales,     1  11       1        1
9  Presidentes municipales, presidentas municipales,    13  23       2        2
10 Presidentes municipales, presidentas municipales,    24  24       3        3
         token      lemma  upos xpos                   feats head_token_id
1       Amigas      amiga  NOUN &lt;NA&gt;  Gender=Fem|Number=Plur             0
2            y          y CCONJ &lt;NA&gt;                    &lt;NA&gt;             3
3       amigos      amigo  NOUN &lt;NA&gt; Gender=Masc|Number=Plur             1
4            ,          , PUNCT &lt;NA&gt;                    &lt;NA&gt;             1
5    Invitados   invitado  NOUN &lt;NA&gt; Gender=Masc|Number=Plur             0
6   especiales   especial   ADJ &lt;NA&gt;             Number=Plur             1
7            ,          , PUNCT &lt;NA&gt;                    &lt;NA&gt;             1
8  Presidentes presidente  NOUN &lt;NA&gt; Gender=Masc|Number=Plur             0
9  municipales  municipal   ADJ &lt;NA&gt;             Number=Plur             1
10           ,          , PUNCT &lt;NA&gt;                    &lt;NA&gt;             4
   dep_rel deps            misc
1     root &lt;NA&gt;            &lt;NA&gt;
2       cc &lt;NA&gt;            &lt;NA&gt;
3     conj &lt;NA&gt;   SpaceAfter=No
4    punct &lt;NA&gt; SpacesAfter=\\n
5     root &lt;NA&gt;            &lt;NA&gt;
6     amod &lt;NA&gt;   SpaceAfter=No
7    punct &lt;NA&gt; SpacesAfter=\\n
8     root &lt;NA&gt;            &lt;NA&gt;
9     amod &lt;NA&gt;   SpaceAfter=No
10   punct &lt;NA&gt;            &lt;NA&gt;</code></pre>
</div>
</div>
<p>¿Con cuales UPOS se trabaja? <a href="https://universaldependencies.org/u/pos/" class="uri">https://universaldependencies.org/u/pos/</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>amlo_udpipe <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(upos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  upos   n      percent valid_percent
   ADJ 280 0.0602668963  0.0610953524
   ADP 715 0.1538958244  0.1560113463
   ADV 189 0.0406801550  0.0412393629
   AUX 179 0.0385277658  0.0390573860
 CCONJ 194 0.0417563495  0.0423303513
   DET 607 0.1306500215  0.1324459961
  INTJ   1 0.0002152389  0.0002181977
  NOUN 889 0.1913473956  0.1939777438
   NUM 126 0.0271201033  0.0274929086
  PRON 207 0.0445544554  0.0451669212
 PROPN 166 0.0357296599  0.0362208161
 PUNCT 466 0.1003013345  0.1016801222
 SCONJ 137 0.0294877314  0.0298930831
   SYM   1 0.0002152389  0.0002181977
  VERB 426 0.0916917779  0.0929522147
  &lt;NA&gt;  63 0.0135600517            NA</code></pre>
</div>
</div>
<p>¿Qué no logró identificar?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>amlo_udpipe <span class="sc">%&gt;%</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(upos)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(token)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      token  n    percent
         Al  1 0.01587302
  agregarse  2 0.03174603
         al 21 0.33333333
      darle  1 0.01587302
  dedicarse  1 0.01587302
        del 35 0.55555556
 haciéndole  1 0.01587302
  venderlos  1 0.01587302</code></pre>
</div>
</div>
<p>La clasificación de las UPOS nos permite hacer filtro por el tipo de palabra que queremos analizar, seguro los sustantivos son los que más queremos revisar:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>amlo_udpipe <span class="sc">%&gt;%</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(upos<span class="sc">==</span><span class="st">"NOUN"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(token) <span class="sc">%&gt;%</span> </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        token  n     percent
     millones 16 0.017997750
    inversión 13 0.014623172
         país 12 0.013498313
 trabajadores 12 0.013498313
 construcción 10 0.011248594
     gobierno 10 0.011248594
    refinería  9 0.010123735
       tiempo  9 0.010123735
      trabajo  9 0.010123735
     política  8 0.008998875</code></pre>
</div>
</div>
<p>Además de los “tokens” podemos pedirles los “lemma”, que como vemos quita el género y el número</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>amlo_udpipe <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(upos<span class="sc">==</span><span class="st">"NOUN"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(lemma) <span class="sc">%&gt;%</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      lemma  n    percent
     millón 19 0.02137233
       país 16 0.01799775
  inversión 13 0.01462317
  refinería 13 0.01462317
    empresa 12 0.01349831
   gobierno 12 0.01349831
       obra 12 0.01349831
     tiempo 12 0.01349831
 trabajador 12 0.01349831
        año 11 0.01237345</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>

<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./P14.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introducción a los tableros con <code>{shiny}</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./P16.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Análisis de texto (II)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>